<!doctype html>
<html>

<head>
  <link rel="icon"
      type="image/png"
      href="images/favicon.png">
  <meta charset="utf-8">
  <title>IWP Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@0.6.2/dist/leaflet.css" />
  <link href='https://api.mapbox.com/mapbox-assembly/v0.8.0/assembly.min.css' rel='stylesheet'>
  <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">

  <style type="text/css">
    header {
      background-image: url('images/bookshelf_bw.jpeg');
      position: fixed;
      width: 100%;
      height: 0px;
      background-color: #000000;
      box-shadow: 0px 5px 5px black;
      z-index: 800;
    }

    h1 {
      font-size: 20px;
      font-family: 'Montserrat', sans-serif;
      display: inline-block;
      color: black;
      margin-left: 0px;
      margin-right: 30px;
      padding-top: 20px;
      padding-bottom: 10px;
    }

    h3 {
      font-size: 14px;
      font-style: bold;
      font-family: 'Montserrat', sans-serif;
      padding-top: 5px;
    }

    body {
      margin: 0px;
      height: 100%;
      width: 100%;
      background: #FFFFF0;
    }

    #container {
      margin: 0px;
      width: 100%;
    }

    #contentwrapper {
      float: left;
      width: 100%;
      overflow: hidden;
    }

    #leftcolumn {
      float: left;
      width: 23%;
      background: #FFFFF0;
      padding: 5px;
      height: 100%;
    }

    #contentcolumn {
      float: left;
      margin: 0px;
      width: 77%;
      margin-bottom: 0px;
    }

    .innertube {
      margin: 5px;
      margin-top: 5px;
    }

    #map {
      position: fixed;
      top: 0px;
      bottom: 0px;
      width: 77%;
      background: white;
      border-left: 1px solid gray;
    }

    #slider {
      position: absolute;
      height: 43px;
      bottom: 0px;
      left: 120px;
      z-index: 1000;
      background-color: white;
      border-left: 1px solid;
      border-right: 1px solid;
      border-top: 1px solid;
      border-bottom: 1px solid
    }

    #temporal {
      background-color: white;
      height: 43px
    }

    .logo-resize {
      width: auto;
      height: 80px;
    }

    a:hover {
      cursor:pointer;
    }

    #formsubmit, #formreset, #timeline-anm, #timeline-button {
      background-color: #008CBA;
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 12px;
    }

    #formsubmit:hover, #formreset:hover, #timeline-anm:hover, #timeline-button:hover {
      background-color: #72bcd4;
    }

    #formsubmit {
      margin-top: 5px;
    }

    #timeline-anm {
      margin: 5px;
    }
  </style>
</head>

<body>
  <div id="container">
    <div id="contentwrapper">
      <!--
      <header>
        <h1>THE UNIVERSITY OF IOWA INTERNATIONAL WRITING PROGRAM: 1966-PRESENT</h1>
      </header>
      -->
      <div id="leftcolumn">
        <div class="innertube">
          <form id="map_parameters" name="map_parameters" action="#" accept-charset="utf-8" class="inlineForm">
            <!--<form id="map_parameters" name="map_parameters" action="http://iwp.lib.uiowa.edu/index.php/iwpmap" method="post" accept-charset="utf-8" class="inlineForm">-->
            <!-- 	hidden input fields will be modified by the time slider -->
            <input id="timeline_start" name="timeline_start" type="hidden" value="1966">
            <input id="timeline_end" name="timeline_end" type="hidden" value="2023">
            <input id="timeline_display" name="timeline_display" type="hidden" value="none" ;="" <hr="">
            <ul class="no_marker">
              <a href="https://iwp.uiowa.edu/" target="_blank"><img class='logo-resize' src='images/iwp-logo.png'/></a>
              <h1>THE UNIVERSITY OF IOWA INTERNATIONAL WRITING PROGRAM: 1967-PRESENT</h1>
              <p>Search the database of over 1,500 IWP participants since 1967 by
                any combination of categories. Totals are for instances of
                participation, and writers may have participated more than once.</p>
              <li class="menu_item"><strong>Country:</strong>
                <select id="country">
                  <option value="0" selected="selected">[any]</option>
                  <option value="1901">Afghanistan</option>
                  <option value="1865">Albania</option>
                  <option value="2030">Algeria</option>
                  <option value="1955">Argentina</option>
                  <option value="1903">Armenia</option>
                  <option value="1908">Australia</option>
                  <option value="1960">Austria</option>
                  <option value="2029">Bahrain</option>
                  <option value="1926">Bangladesh</option>
                  <option value="1943">Barbados</option>
                  <option value="1856">Belarus</option>
                  <option value="1843">Belgium</option>
                  <option value="2010">Benin</option>
                  <option value="1844">Bolivia</option>
                  <option value="1966">Bosnia-Herzegovina</option>
                  <option value="2024">Botswana</option>
                  <option value="1889">Brazil</option>
                  <option value="1921">Bulgaria</option>
                  <option value="1975">Burma/Myanmar</option>
                  <option value="2023">Burundi</option>
                  <option value="1947">Cambodia</option>
                  <option value="1993">Cameroon</option>
                  <option value="2047">Canada</option>
                  <option value="1855">Chile</option>
                  <option value="1845">China</option>
                  <option value="1911">Colombia</option>
                  <option value="1880">Costa Rica</option>
                  <option value="1971">Cote d'Ivoire</option>
                  <option value="1944">Croatia</option>
                  <option value="1892">Cuba</option>
                  <option value="1934">Cyprus</option>
                  <option value="1953">Czechoslovakia</option>
                  <option value="1946">Czech Republic</option>
                  <option value="1852">Denmark</option>
                  <option value="2039">Djibouti</option>
                  <option value="1957">Ecuador</option>
                  <option value="1875">Egypt</option>
                  <option value="2067">Eritrea</option>
                  <option value="1878">Estonia</option>
                  <option value="1866">Ethiopia</option>
                  <option value="1909">Fiji</option>
                  <option value="1853">Finland</option>
                  <option value="1923">France</option>
                  <option value="1898">Georgia</option>
                  <option value="1991">German Democratic Republic (DDR)</option>
                  <option value="1995">German Federal Republic (BRD)</option>
                  <option value="1862">Germany</option>
                  <option value="1857">Ghana</option>
                  <option value="1881">Greece</option>
                  <option value="1996">Grenada</option>
                  <option value="1861">Guatemala</option>
                  <option value="2071">Guinea-Bissau</option>
                  <option value="2006">Guyana</option>
                  <option value="1900">Haiti</option>
                  <option value="1925">Honduras</option>
                  <option value="1978">Hong Kong</option>
                  <option value="1890">Hungary</option>
                  <option value="1879">Iceland</option>
                  <option value="1959">India</option>
                  <option value="1949">Indonesia</option>
                  <option value="1939">Iran</option>
                  <option value="1872">Iraq</option>
                  <option value="1964">Ireland</option>
                  <option value="1931">Israel</option>
                  <option value="1913">Italy</option>
                  <option value="1935">Jamaica</option>
                  <option value="1912">Japan</option>
                  <option value="1945">Jordan</option>
                  <option value="1885">Kazakhstan</option>
                  <option value="1936">Kenya</option>
                  <option value="2066">Kosovo</option>
                  <option value="1914">Kuwait</option>
                  <option value="1895">Kyrgyzstan</option>
                  <option value="1877">Laos</option>
                  <option value="1886">Latvia</option>
                  <option value="1847">Lebanon</option>
                  <option value="1848">Liberia</option>
                  <option value="1922">Libya</option>
                  <option value="1876">Lithuania</option>
                  <option value="1893">Luxembourg</option>
                  <option value="2065">Macau</option>
                  <option value="1904">Macedonia</option>
                  <option value="1849">Madagascar</option>
                  <option value="1868">Malawi</option>
                  <option value="1867">Malaysia</option>
                  <option value="1873">Malta</option>
                  <option value="1882">Mauritius</option>
                  <option value="1937">Mexico</option>
                  <option value="1846">Moldova</option>
                  <option value="1954">Mongolia</option>
                  <option value="1917">Montenegro</option>
                  <option value="1874">Morocco</option>
                  <option value="1888">Mozambique</option>
                  <option value="2068">Namibia</option>
                  <option value="1851">Nepal</option>
                  <option value="1967">Netherlands</option>
                  <option value="1932">New Zealand</option>
                  <option value="1858">Nicaragua</option>
                  <option value="2069">Niger</option>
                  <option value="1916">Nigeria</option>
                  <option value="1920">Norway</option>
                  <option value="2015">Oman</option>
                  <option value="1905">Pakistan</option>
                  <option value="1974">Palestine</option>
                  <option value="1961">Panama</option>
                  <option value="1894">Papua New Guinea</option>
                  <option value="1924">Paraguay</option>
                  <option value="1969">Peru</option>
                  <option value="1958">Philippines</option>
                  <option value="1927">Poland</option>
                  <option value="1919">Portugal</option>
                  <option value="1956">Romania</option>
                  <option value="1928">Russia</option>
                  <option value="1948">Rwanda</option>
                  <option value="1883">Saudi Arabia</option>
                  <option value="1871">Senegal</option>
                  <option value="2036">Serbia</option>
                  <option value="1897">Sierra Leone</option>
                  <option value="1863">Singapore</option>
                  <option value="1940">Slovakia</option>
                  <option value="1915">Slovenia</option>
                  <option value="1850">South Africa</option>
                  <option value="1963">South Korea</option>
                  <option value="1854">Spain</option>
                  <option value="1951">Sri Lanka</option>
                  <option value="1941">Sudan</option>
                  <option value="1962">Sweden</option>
                  <option value="1869">Switzerland</option>
                  <option value="1929">Syria</option>
                  <option value="1887">Taiwan</option>
                  <option value="1910">Tanzania</option>
                  <option value="1906">Thailand</option>
                  <option value="1976">Tibet</option>
                  <option value="1942">Togo</option>
                  <option value="1972">Trinidad</option>
                  <option value="1902">Turkey</option>
                  <option value="1918">Uganda</option>
                  <option value="1870">Ukraine</option>
                  <option value="2070">United Arab Emirates</option>
                  <option value="1884">United Kingdom</option>
                  <option value="1933">United States of America</option>
                  <option value="1891">Uruguay</option>
                  <option value="1907">USSR</option>
                  <option value="1938">Uzbekistan</option>
                  <option value="1952">Venezuela</option>
                  <option value="1950">Vietnam</option>
                  <option value="1968">Wales</option>
                  <option value="2056">Yemen</option>
                  <option value="1864">Yugoslavia</option>
                  <option value="1896">Zambia</option>
                  <option value="1899">Zimbabwe</option>
                </select>
              </li>
              <li class="menu_item"><strong>Region:</strong>
                <select id="region">
                  <option value="0" selected="selected">[any]</option>
                  <option value="Australia and New Zealand">Australia and New Zealand </option>
                  <option value="Caribbean">Caribbean </option>
                  <option value="Central America">Central America </option>
                  <option value="Central Asia">Central Asia </option>
                  <option value="Eastern Africa">Eastern Africa </option>
                  <option value="Eastern Asia">Eastern Asia </option>
                  <option value="Eastern Europe">Eastern Europe </option>
                  <option value="Melanesia">Melanesia </option>
                  <option value="Micronesia">Micronesia </option>
                  <option value="Middle Africa">Middle Africa </option>
                  <option value="Northern Africa">Northern Africa </option>
                  <option value="Northern America">North America </option>
                  <option value="Northern Europe">Northern Europe </option>
                  <option value="Polynesia">Polynesia </option>
                  <option value="South America">South America </option>
                  <option value="South-Eastern Asia">South-Eastern Asia </option>
                  <option value="Southern Africa">Southern Africa </option>
                  <option value="Southern Asia">Southern Asia </option>
                  <option value="Southern Europe">Southern Europe </option>
                  <option value="Western Africa">Western Africa </option>
                  <option value="Western Asia">Western Asia </option>
                  <option value="Western Europe">Western Europe </option>
                </select>
              </li>
              <li class="menu_item"><strong>Macro Region:</strong>
                <select id="macro_region">
                  <option value="0" selected="selected">[any]</option>
                  <option value="Africa">Africa </option>
                  <option value="Asia">Asia </option>
                  <option value="Europe">Europe </option>
                  <option value="Oceania">Oceania </option>
                  <option value="The Americas">The Americas </option>
                </select>
              </li>
              <li class="menu_item"><strong>Year of Residency:</strong>&nbsp;&nbsp;
                <select id="residency">
                  <option value="0">[any]</option>
                  <option value="1966">1966</option>
                  <option value="1967">1967</option>
                  <option value="1968">1968</option>
                  <option value="1969">1969</option>
                  <option value="1970">1970</option>
                  <option value="1971">1971</option>
                  <option value="1972">1972</option>
                  <option value="1973">1973</option>
                  <option value="1974">1974</option>
                  <option value="1975">1975</option>
                  <option value="1976">1976</option>
                  <option value="1977">1977</option>
                  <option value="1978">1978</option>
                  <option value="1979">1979</option>
                  <option value="1980">1980</option>
                  <option value="1981">1981</option>
                  <option value="1982">1982</option>
                  <option value="1983">1983</option>
                  <option value="1984">1984</option>
                  <option value="1985">1985</option>
                  <option value="1986">1986</option>
                  <option value="1987">1987</option>
                  <option value="1988">1988</option>
                  <option value="1989">1989</option>
                  <option value="1990">1990</option>
                  <option value="1991">1991</option>
                  <option value="1992">1992</option>
                  <option value="1993">1993</option>
                  <option value="1994">1994</option>
                  <option value="1995">1995</option>
                  <option value="1996">1996</option>
                  <option value="1997">1997</option>
                  <option value="1998">1998</option>
                  <option value="1999">1999</option>
                  <option value="2000">2000</option>
                  <option value="2001">2001</option>
                  <option value="2002">2002</option>
                  <option value="2003">2003</option>
                  <option value="2004">2004</option>
                  <option value="2005">2005</option>
                  <option value="2006">2006</option>
                  <option value="2007">2007</option>
                  <option value="2008">2008</option>
                  <option value="2009">2009</option>
                  <option value="2010">2010</option>
                  <option value="2011">2011</option>
                  <option value="2012">2012</option>
                  <option value="2013">2013</option>
                  <option value="2014">2014</option>
                  <option value="2015">2015</option>
                  <option value="2016">2016</option>
                  <option value="2017">2017</option>
                  <option value="2018">2018</option>
                  <option value="2019">2019</option>
                  <option value="2020">2020</option>
                  <option value="2021">2021</option>
                  <option value="2022">2022</option>
                  <option value="2023" selected="selected">2023</option>
                </select><br>
                <!-- Hide the following, if you are not allowing the user to switch between annual and cumulative results,
                but rather only allowing for annual results. Otherwise, delete this and comment in the two radio inputs that follow.-->
                <!--<input type="hidden" name="count_type" value="annual" class="in1" checked="checked">-->

                <input type="radio" name="count_type" value="annual" class="in1" checked="checked">
                This year only&nbsp;&nbsp;&nbsp;
                <input type="radio" name="count_type" value="cumulative" class="in1" checked="checked">
                Cumulative<br>

              </li>
              <li class="menu_item"><strong>Author Languages:</strong>
                <input type="radio" name="multilingual" value="1" class="in1" checked="checked">
                1+
                <input type="radio" name="multilingual" value="2" class="in1">
                2+<br>
              </li>
              <li class="menu_item"><strong>Language:</strong>&nbsp;&nbsp;
                <select id="language">
                  <option value="0" selected="selected">[any]</option>
                  <option value="Afrikaans">Afrikaans </option>
                  <option value="Albanian">Albanian </option>
                  <option value="Arabic">Arabic </option>
                  <option value="Armenian">Armenian </option>
                  <option value="Azerbaijani">Azerbaijani </option>
                  <option value="Basque">Basque </option>
                  <option value="Belarusian">Belarusian </option>
                  <option value="Bengali">Bengali </option>
                  <option value="Bosnian">Bosnian </option>
                  <option value="Bulgarian">Bulgarian </option>
                  <option value="Burmese">Burmese </option>
                  <option value="Catalan">Catalan </option>
                  <option value="Chichewa">Chichewa </option>
                  <option value="Chinese">Chinese </option>
                  <option value="Croatian">Croatian </option>
                  <option value="Czech">Czech </option>
                  <option value="Danish">Danish </option>
                  <option value="Dari">Dari </option>
                  <option value="Dutch">Dutch </option>
                  <option value="English">English </option>
                  <option value="Estonian">Estonian </option>
                  <option value="Filipino">Filipino </option>
                  <option value="Finnish">Finnish </option>
                  <option value="Flemish">Flemish </option>
                  <option value="French">French </option>
                  <option value="Georgian">Georgian </option>
                  <option value="German">German </option>
                  <option value="Greek">Greek </option>
                  <option value="Hebrew">Hebrew </option>
                  <option value="Hindi">Hindi </option>
                  <option value="Hungarian">Hungarian </option>
                  <option value="Icelandic">Icelandic </option>
                  <option value="Indonesian">Indonesian </option>
                  <option value="Italian">Italian </option>
                  <option value="Japanese">Japanese </option>
                  <option value="Kannada">Kannada </option>
                  <option value="Khmer">Khmer </option>
                  <option value="Korean">Korean </option>
                  <option value="Lao">Lao </option>
                  <option value="Latvian">Latvian </option>
                  <option value="Lithuanian">Lithuanian </option>
                  <option value="Macedonian">Macedonian </option>
                  <option value="Malay">Malay </option>
                  <option value="Maltese">Maltese </option>
                  <option value="Mauritian Créole">Mauritian Créole </option>
                  <option value="Mongolian">Mongolian </option>
                  <option value="Nahuatl">Nahuatl </option>
                  <option value="Nepali">Nepali </option>
                  <option value="Norwegian">Norwegian </option>
                  <option value="Pashto">Pashto </option>
                  <option value="Persian">Persian </option>
                  <option value="Polish">Polish </option>
                  <option value="Portuguese">Portuguese </option>
                  <option value="Romanian">Romanian </option>
                  <option value="Russian">Russian </option>
                  <option value="Serbian">Serbian </option>
                  <option value="Setswana">Setswana </option>
                  <option value="Sindhi">Sindhi </option>
                  <option value="Sinhalese">Sinhalese </option>
                  <option value="Slovak">Slovak </option>
                  <option value="Slovenian">Slovenian </option>
                  <option value="Spanish">Spanish </option>
                  <option value="Swedish">Swedish </option>
                  <option value="Tagalog">Tagalog </option>
                  <option value="Tamil">Tamil </option>
                  <option value="Thai">Thai </option>
                  <option value="Tigrigna">Tigrigna </option>
                  <option value="Turkish">Turkish </option>
                  <option value="Ukrainian">Ukrainian </option>
                  <option value="Urdu">Urdu </option>
                  <option value="Uzbek">Uzbek </option>
                  <option value="Vietnamese">Vietnamese </option>
                  <option value="Welsh">Welsh </option>
                  <option value="Xhosa">Xhosa </option>
                  <option value="Yiddish">Yiddish </option>
                </select>
              </li>
              <li class="menu_item"><strong>Writer Role:</strong>&nbsp;&nbsp;
                <select id="role">
                  <option value="0" selected="selected">[any]</option>
                  <option value="activist">activist </option>
                  <option value="arts promoter">arts promoter </option>
                  <option value="children's author">children's author </option>
                  <option value="critic">critic </option>
                  <option value="director">director </option>
                  <option value="editor">editor </option>
                  <option value="educator">educator </option>
                  <option value="essayist">essayist </option>
                  <option value="fiction writer">fiction writer </option>
                  <option value="filmmaker">filmmaker </option>
                  <option value="journalist">journalist </option>
                  <option value="librettist">librettist </option>
                  <option value="lyricist">lyricist </option>
                  <option value="non-fiction writer">non-fiction writer </option>
                  <option value="performance artist">performance artist </option>
                  <option value="physician">physician </option>
                  <option value="playwright">playwright </option>
                  <option value="poet">poet </option>
                  <option value="publisher">publisher </option>
                  <option value="scholar">scholar </option>
                  <option value="screenwriter">screenwriter </option>
                  <option value="spoken-word artist">spoken-word artist </option>
                  <option value="translator">translator </option>
                  <option value="visual artist">visual artist </option>
                </select>
              </li>
              <li class="menu_item"><strong>Gender: </strong>&nbsp;&nbsp;
                <select id="gender">
                  <option value="0" selected="selected">[any]</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                </select>
              </li>
              <!--
              <li class="menu_item"><strong>Gender: </strong>
                <input type="radio" name="gender" value="Male" class="in1">
                Male&nbsp;&nbsp;&nbsp;
                <input type="radio" name="gender" value="Female" class="in1">
                Female<br>
              </li>
              -->
              <li class="menu_item"><strong>Year of Birth:</strong>&nbsp;&nbsp;
                <select id="YOB">
                  <option value="0" selected="selected">[any]</option>
                  <option value="1905">1905</option>
                  <option value="1906">1906</option>
                  <option value="1907">1907</option>
                  <option value="1908">1908</option>
                  <option value="1909">1909</option>
                  <option value="1910">1910</option>
                  <option value="1911">1911</option>
                  <option value="1912">1912</option>
                  <option value="1913">1913</option>
                  <option value="1914">1914</option>
                  <option value="1915">1915</option>
                  <option value="1916">1916</option>
                  <option value="1917">1917</option>
                  <option value="1918">1918</option>
                  <option value="1919">1919</option>
                  <option value="1920">1920</option>
                  <option value="1921">1921</option>
                  <option value="1922">1922</option>
                  <option value="1923">1923</option>
                  <option value="1924">1924</option>
                  <option value="1925">1925</option>
                  <option value="1926">1926</option>
                  <option value="1927">1927</option>
                  <option value="1928">1928</option>
                  <option value="1929">1929</option>
                  <option value="1930">1930</option>
                  <option value="1931">1931</option>
                  <option value="1932">1932</option>
                  <option value="1933">1933</option>
                  <option value="1934">1934</option>
                  <option value="1935">1935</option>
                  <option value="1936">1936</option>
                  <option value="1937">1937</option>
                  <option value="1938">1938</option>
                  <option value="1939">1939</option>
                  <option value="1940">1940</option>
                  <option value="1941">1941</option>
                  <option value="1942">1942</option>
                  <option value="1943">1943</option>
                  <option value="1944">1944</option>
                  <option value="1945">1945</option>
                  <option value="1946">1946</option>
                  <option value="1947">1947</option>
                  <option value="1948">1948</option>
                  <option value="1949">1949</option>
                  <option value="1950">1950</option>
                  <option value="1951">1951</option>
                  <option value="1952">1952</option>
                  <option value="1953">1953</option>
                  <option value="1954">1954</option>
                  <option value="1955">1955</option>
                  <option value="1956">1956</option>
                  <option value="1957">1957</option>
                  <option value="1958">1958</option>
                  <option value="1959">1959</option>
                  <option value="1960">1960</option>
                  <option value="1961">1961</option>
                  <option value="1962">1962</option>
                  <option value="1963">1963</option>
                  <option value="1964">1964</option>
                  <option value="1965">1965</option>
                  <option value="1966">1966</option>
                  <option value="1967">1967</option>
                  <option value="1968">1968</option>
                  <option value="1969">1969</option>
                  <option value="1970">1970</option>
                  <option value="1971">1971</option>
                  <option value="1972">1972</option>
                  <option value="1973">1973</option>
                  <option value="1974">1974</option>
                  <option value="1975">1975</option>
                  <option value="1976">1976</option>
                  <option value="1977">1977</option>
                  <option value="1978">1978</option>
                  <option value="1979">1979</option>
                  <option value="1980">1980</option>
                  <option value="1981">1981</option>
                  <option value="1982">1982</option>
                  <option value="1983">1983</option>
                  <option value="1984">1984</option>
                  <option value="1985">1985</option>
                  <option value="1986">1986</option>
                  <option value="1987">1987</option>
                  <option value="1988">1988</option>
                  <option value="1989">1989</option>
                  <option value="1990">1990</option>
                  <option value="1991">1991</option>
                  <option value="1992">1992</option>
                  <option value="1993">1993</option>
                  <option value="1994">1994</option>
                  <option value="1995">1995</option>
                  <option value="1996">1996</option>
                  <option value="1997">1997</option>
                  <option value="1998">1998</option>
                  <option value="1999">1999</option>
                  <option value="2000">2000</option>
                  <option value="2001">2001</option>
                  <option value="2002">2002</option>
                  <option value="2003">2003</option>
                  <option value="2004">2004</option>
                  <option value="2005">2005</option>
                  <option value="2006">2006</option>
                  <option value="2007">2007</option>
                  <option value="2008">2008</option>
                  <option value="2009">2009</option>
                  <option value="2010">2010</option>
                  <option value="2011">2011</option>
                  <option value="2012">2012</option>
                  <option value="2013">2013</option>
                  <option value="2014">2014</option>
                  <option value="2015">2015</option>
                  <option value="2016">2016</option>
                  <option value="2017">2017</option>
                  <option value="2018">2018</option>
                  <option value="2019">2019</option>
                  <option value="2020">2020</option>
                  <option value="2021">2021</option>
                </select>
              </li>
            </ul>
            <hr>
            <div class="centered">
              <button id="formsubmit" type="submit" value="apply">Apply Query</button>
              <button id="formreset" type="submit" value="reset" onclick="resetForm()">Reset Form</button>
              <!--
              &nbsp;&nbsp;&nbsp;
              <form action="http://iwp.lib.uiowa.edu/index.php/iwpmap" method="post" accept-charset="utf-8" class="inlineForm">
                <button name="clear" type="submit" value="clear">Clear / Reset</button>
              </form>
              -->
            </div>
          </form>
        </div>

        <div id="timeline-anm" style="cursor: pointer" class="timeline-anm" onclick="location.href='index-cumulative.html'">Cumulative Map</div>
        <!--<div id="timeline-button" style="cursor: pointer" class="timeline-btn" onclick="toggleTimeline();">
          Show Timeline

	<a href="http://iwp.lib.uiowa.edu/timeline"><img src = "http://iwp.lib.uiowa.edu/resources/img/TimeLineButton2.png" ></a>
          <div class="centered">
          </div>
        </div>-->
      </div>
      <div id="contentcolumn">
        <div id="map"></div>

        <!-- ui slider -->
        <!--
        <div id='slider' class='range w300 round py6 border--gray-light px12 leaflet-control'>
          <input type='range' min="1966" max="2016" value="1966" step="1" class="slider" />
        </div>
        -->
        <!-- end slider -->
        <!-- temporal legend -->
        <!--
        <div id='temporal' class='py6 px12 border border--gray-light round bottom left wmax200'>
          <h3 class='txt-bold'>Year: <span></span></h3>
        </div>
      -->
        <!-- end temporal -->

      </div>
    </div>
  </div>
  <script src="https://unpkg.com/leaflet@0.6.2/dist/leaflet.js"></script>
  <script type="text/javascript" src="js/proj4js-compressed.js"></script>
  <script type="text/javascript" src="js/proj4leaflet.js"></script>
  <script type="text/javascript" src="js/L.Graticule.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <!-- for statistics, classifications -->
  <script src='js/simple-statistics.min.js'></script>
  <script type="text/javascript">
    // Sphere Mollweide: http://spatialreference.org/ref/esri/53009/
    var crs = new L.Proj.CRS('ESRI:53009', '+proj=moll +lon_0=0 +x_0=0 +y_0=0 +a=6371000 +b=6371000 +units=m +no_defs', {
      resolutions: [65536, 32768, 16384, 8192, 4096, 2048]
    });

    var map = L.map('map', {
      crs: crs,
      maxZoom: 5,
      minZoom: 1,
      zoomAnimation: false
    });

    L.graticule({
      sphere: true,
      style: {
        color: '#777',
        opacity: 1,
        fillColor: '#A2E2E8',
        fillOpacity: 1,
        weight: 2
      }
    }).addTo(map);

    L.graticule({
      style: {
        color: '#777',
        weight: 1,
        opacity: 0.5
      }
    }).addTo(map);

    // Fit the map to the world
    map.fitWorld();

    // Define a getOpacity function
    function getOpacity(d) {
      return d > 0 ? '1.0' :
        '0.0';
    }

    // Define a getWeight function
    function getWeight(d) {
      return d > 0 ? '0.5' :
        '0.0';
    }

    // define the selected year
    var currentYear = document.getElementById("residency").value;

    // define the input form
    var filters = document.getElementById('map_parameters');

    // define the form submit button
    var formSubmit = document.getElementById('formsubmit');

    // on page load...
    window.onload = function() {
      // Set a timeout to prevent problems with writer info not loading in Chrome
      setTimeout(() => {
        // click the form submit button
        formSubmit.click();
      }, 100);
    };

    // define a function to reset the form upon clicking the "Reset Form" button
    function resetForm() {
      // reset all input filters
      filters.reset();
      // click the form submit button
      formSubmit.click();
    };

    // define an empty array to hold the geojson properties
    var geojsonProperties = [];

    var output = [];

    // Create a feature group to store polygons
    var filteredCountries = L.featureGroup().addTo(map);

    // load the data asynchronously
    d3.queue()
      .defer(d3.json, 'data/Land_WGS84.json') // the continents, land masses
      .defer(d3.json, 'data/Nations_Writers_new.json') // the historical countries layer
      .defer(d3.csv, 'data/IWP_for_json.csv') // the centroids layer
      .await(drawMap); // load the layers after the map loads

    // define drawMap function
    function drawMap(err, land, countries, cumulative) {

      var earth = L.geoJson(land, {
        style: function(feature) {
          return {
            stroke: 1,
            color: 'grey',
            strokeOpacity: 1,
            weight: 1,
            fillColor: '#A8B59F',
            fillOpacity: 1
          }
        }
      }).addTo(map); // keeps the earth layer from being placed over the circle markers upon map load

      var nations = L.geoJson(countries, {
        style: function(feature) {
          return {
            stroke: 1,
            color: 'grey',
            weight: 1,
            fillColor: '#1C00ff00',
            fillOpacity: 1,
          }
        }
      }); // end nations layer

      // call the drawCircles function
      drawCircles(cumulative, nations);

    }; // end drawMap function

    // calculate circle radii
    function calcRadius(val) {
      var radius = Math.sqrt(val / Math.PI);
      return radius * 16; // adjust 16 as a scale factor
    }; // end calcRadius() function

    // draw proportional circles
    function drawCircles(cumulative, nations) {

      // build the geojson from the csv data
      var geojson = {
        "type": "FeatureCollection",
        "features": []
      }

      var feature;

      cumulative.forEach(function(datum) {

        // add coordinate data as points
        feature = {
          "type": "Feature",
          "geometry": {
            "type": "Point",
            "coordinates": [datum.long, datum.lat]
          },
          "properties": datum
        }

        // push points to a geojson feature collection
        geojson.features.push(feature);

      });

      //geojsonProperties.length = 0;

      // push the geojson properties to the empty array
      geojsonProperties.push(geojson.features.map(function(feature) {
        return feature.properties;
      }));

      // define the cumulativeMultilingualProps
      var cumulativeMultilingualProps = geojsonProperties[0];

      // define a circle variable for each year
      var cumulativePart = L.geoJson(geojson, {

        pointToLayer: function(feature, ll) {

          return L.circleMarker(ll, {
            color: '#873620',
            fillColor: '#873620',
            opacity: 1,
            weight: 1,
            fillOpacity: 0.25
          })
        },

        // bind popup content to each layer feature
        onEachFeature: function(feature, layer) {

          // define properties
          var props = layer.feature.properties;
          // define circle radius with a formula
          var radius = calcRadius(Number(props.writer_total_cumulative));
          // bind a popup with the cumulative popup content
/*
          layer.bindPopup(props.popup_cumulative, {
            maxHeight: 300,
            maxWidth: 350
          });
*/
          // give the layer a subtle style on mouseover
          layer.on("mouseover", function(e) {
            layer.setStyle({
              fillColor: '#fed8b1',
            });
          });
          // return to the original style on mouseout
          layer.on("mouseout", function(e) {
            layer.setStyle({
              fillColor: '#873620',
            });
          });

          // if the current year is greater than or equal to the min_year or
          // if it is less than or equal to the max_year...
          if (currentYear >= props.min_year && currentYear <= props.max_year) {
            // set the radius using the variable above
            setLayerProperties(layer, radius);
            // otherwise...
          } else {
            // set the radius to zero
            removeLayerProperties(layer);
          };

        }

      });

      updateLayers(cumulativePart, nations, cumulativeMultilingualProps, currentYear);

    }; // end drawCircles() function

    // update the layers with the input year
    function updateLayers(cumulativePart, nations, cumulativeMultilingualProps, currentYear) {

      // when the form is submitted...
      filters.addEventListener('submit', function updateData(e) {

        // prevent page reload
        e.preventDefault();

        // define updateYear as the selected residency year
        var updateYear = document.getElementById("residency").value;

        if (updateYear == 0) {
          var updateYear = currentYear;
        };

        // use the eachLayer method to access all objects of the nations layer
        nations.eachLayer(function(layer) {
          // filter features
          if (layer.feature.properties.Start_Year <= updateYear && updateYear <= layer.feature.properties.End_Year) {
            filteredCountries.addLayer(layer);
          } else {
            filteredCountries.removeLayer(layer);
          }
/*
          // dynamically set styles for all nations based on properties linked to
          // the designated year using the the following "get" functions
          layer.setStyle({
            strokeOpacity: getOpacity(layer.feature.properties['Year_' + updateYear])
          });
          layer.setStyle({
            weight: getWeight(layer.feature.properties['Year_' + updateYear])
          });
          layer.setStyle({
            fillOpacity: getOpacity(layer.feature.properties['Year_' + updateYear])
          });
*/
        }); // end nations.eachLayer

        // call updatePoints function
        updatePoints(cumulativePart, cumulativeMultilingualProps, updateYear);

      });

    }; // end updateLayers() function

    // form-based update
    function updatePoints(cumulativePart, cumulativeMultilingualProps, updateYear) {

      // define form inputs
      var country = document.getElementById("country").value;
      var region = document.getElementById("region").value;
      var macroRegion = document.getElementById("macro_region").value;
      //var residency = document.getElementById("residency").value;
      var counts = document.querySelectorAll('input[name="count_type"]');
      var countValue;
      for (var count of counts) {
        if (count.checked) {
          countValue = count.value;
          break;
        }
      };
      var langs = document.querySelectorAll('input[name="multilingual"]');
      var langValue;
      for (var lang of langs) {
        if (lang.checked) {
          langValue = lang.value;
          break;
        }
      };
      var language = document.getElementById("language").value;
      var role = document.getElementById("role").value;
      var gender = document.getElementById("gender").value;
      var birth = document.getElementById("YOB").value;

      // if "cumulative" is selected...
      if (countValue == "cumulative") {

        /* TESTING!!! */
        // if a langValue is 1+
        if (langValue == 1) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // gather and define all the popup content
              if (item.writer_1_languages > 0) {
                var popup1 = item.writer_1_popup;
              };
              if (item.writer_2_languages > 0) {
                var popup2 = item.writer_2_popup;
              };
              if (item.writer_3_languages > 0) {
                var popup3 = item.writer_3_popup;
              };
              if (item.writer_4_languages > 0) {
                var popup4 = item.writer_4_popup;
              };
              if (item.writer_5_languages > 0) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's language equals the selection, add the writer's popup content to the front of the writerPop property
            if (output[x].writer_1_languages > 0) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (output[x].writer_2_languages > 0) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (output[x].writer_3_languages > 0) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (output[x].writer_4_languages > 0) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (output[x].writer_5_languages > 0) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        /* END TESTING!!! */

        // if "2+" is selected...
        if (langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });

              // check if writers in the list are monolingual or absent and, if so, set the property equal to ""
              if (item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };

              // concatenate all cumulative multilingual writers in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writerPop == 'string' && typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's language equals the selection, add the writer's popup content to the front of the writerPop property
            if (output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a specific language is selected
        if (language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected language and, if so, designate popup content
              if ([item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language)) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language)) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language)) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language)) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's language equals the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a specific language is selected and "2+" is selected...
        if (language != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected language and use more than one language and, if so, designate popup content
              if ([item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's language equals the selection and the writer uses more than one language, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a role is selected
        if (role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected role
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected role and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role)) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role)) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role)) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role)) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected role in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's role equals the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a specific role is selected and "2+" is selected...
        if (role != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected role
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected role and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected role in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's role equals the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a specific role is selected and a language is selected...
        if (role != 0 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected role and language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected role and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language)) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language)) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language)) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language)) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected role and language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's role and language equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a specific role, "2+", and a language are selected...
        if (role != 0 && langValue == 2 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected role and language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected role and language and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected role and language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's role and language equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if a gender is selected
        if (gender != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and, if so, designate popup content
              if (gender == item.writer_1_gender) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender equals the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender and "2+" are selected...
        if (gender != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and language value, if so, designate popup content
              if (gender == item.writer_1_gender && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and language value equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender and language are selected...
        if (gender != 0 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and language, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language)) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language)) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language)) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language)) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and language equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender and role are selected...
        if (gender != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and role, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role)) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role)) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role)) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role)) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and role equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender and birth are selected...
        if (gender != 0 && birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and birth year, if so, designate popup content
              if (gender == item.writer_1_gender && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, "2+", and language are selected...
        if (gender != 0 && langValue == 2 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected language and gender
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, language, and use more than one language and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected language and gender in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and language equals the selection and the writer uses more than one language, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, "2+", and role are selected...
        if (gender != 0 && langValue == 2 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected role and gender
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected role and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected role and gender in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's role and gender equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, "2+", and birth are selected...
        if (gender != 0 && langValue == 2 && birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, birth year, and language value, if so, designate popup content
              if (gender == item.writer_1_gender && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, birth year, and language value equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, language, and role are selected...
        if (gender != 0 && language != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected gender, role, and language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, role, and language and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language)) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language)) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language)) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language)) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language)) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected gender, role, and language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, role, and language equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language)) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language)) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language)) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language)) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language)) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, language, and birth year are selected...
        if (gender != 0 && language != 0 && birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, language, and birth and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, role, and birth year are selected...
        if (gender != 0 && role != 0 && birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, role, and birth, and if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, role, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, language, role, and birth year are selected...
        if (gender != 0 && language != 0 && role != 0 && birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected gender, role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, role, language, and birth year, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected gender, role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, language, role, and "2+" are selected...
        if (gender != 0 && language != 0 && role != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected gender, role, language
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected gender, role, language, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected gender, role, language in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's gender, role, language equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if gender, language, role, birth year, and "2+" are selected...
        if (gender != 0 && language != 0 && role != 0 && birth != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected gender, role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected gender, role, language, and birth year, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected gender, role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's gender, role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth is selected...
        if (birth != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected birth year, if so, designate popup content
              if (birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth and "2+" are selected...
        if (birth != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected birth year and language value, and if so, designate popup content
              if (item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's birth year and language value equal the selection, add the writer's popup content to the front of the writerPop property
            if (output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth and language are selected...
        if (birth != 0 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected language and birth year and, if so, designate popup content
              if ([item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's language and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth and role are selected...
        if (birth != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected role and birth, and if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's role and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth, "2+", and language are selected...
        if (birth != 0 && langValue == 2 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected language and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected language and birth year, and, if so, designate popup content
              if ([item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected language and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's language and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth, "2+", and role are selected...
        if (birth != 0 && langValue == 2 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected role and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected role and birth year and, if so, designate popup content
              if (birth == item.writer_1_birth && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && item.writer_1_languages > 1) {
                var popup1 = item.writer_1_popup;
              };
              if (birth == item.writer_2_birth && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && item.writer_2_languages > 1) {
                var popup2 = item.writer_2_popup;
              };
              if (birth == item.writer_3_birth && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && item.writer_3_languages > 1) {
                var popup3 = item.writer_3_popup;
              };
              if (birth == item.writer_4_birth && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && item.writer_4_languages > 1) {
                var popup4 = item.writer_4_popup;
              };
              if (birth == item.writer_5_birth && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && item.writer_5_languages > 1) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected role and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's role and birth year equals the selection, add the writer's popup content to the front of the writerPop property
            if (birth == output[x].writer_1_birth && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && output[x].writer_1_languages > 1) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (birth == output[x].writer_2_birth && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && output[x].writer_2_languages > 1) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (birth == output[x].writer_3_birth && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && output[x].writer_3_languages > 1) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (birth == output[x].writer_4_birth && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && output[x].writer_4_languages > 1) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (birth == output[x].writer_5_birth && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && output[x].writer_5_languages > 1) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth, language, and role are selected...
        if (birth != 0 && language != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected role, language, and birth year, and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth, "2+", language, and role are selected...
        if (birth != 0 && langValue == 2 && language != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected role, language, and birth year, and, if so, designate popup content
              if ([item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if ([item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if ([item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if ([item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if ([item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if ([output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if ([output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if ([output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if ([output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if ([output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year and gender are selected...
        if (birth != 0 && gender != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender and birth year, if so, designate popup content
              if (gender == item.writer_1_gender && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, and role are selected...
        if (birth != 0 && gender != 0 && role != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, role, and birth, and if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, role, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, and language are selected...
        if (birth != 0 && gender != 0 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, language, and birth and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, and "2+" are selected...
        if (birth != 0 && gender != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, birth year, and language value, if so, designate popup content
              if (gender == item.writer_1_gender && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, birth year, and language value equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, role, and language are selected...
        if (birth != 0 && gender != 0 && role != 0 && language != 0) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selected gender, role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if writers in the list match the selected gender, role, language, and birth year, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selected gender, role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the writer's gender, role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, role, and "2+" are selected...
        if (birth != 0 && gender != 0 && role != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected gender, role, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected gender, role, and birth year, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected gender, role, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's gender, role, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, language, and "2+" are selected...
        if (birth != 0 && gender != 0 && language != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of writers for the selection
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected gender, language, and birth year and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && birth == item.writer_1_birth && item.writer_1_languages > 2) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && birth == item.writer_2_birth && item.writer_2_languages > 2) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && birth == item.writer_3_birth && item.writer_3_languages > 2) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && birth == item.writer_4_birth && item.writer_4_languages > 2) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && birth == item.writer_5_birth && item.writer_5_languages > 2) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative writers for the selection in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's gender, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && birth == output[x].writer_1_birth && output[x].writer_1_languages > 2) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && birth == output[x].writer_2_birth && output[x].writer_2_languages > 2) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && birth == output[x].writer_3_birth && output[x].writer_3_languages > 2) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && birth == output[x].writer_4_birth && output[x].writer_4_languages > 2) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && birth == output[x].writer_5_birth && output[x].writer_5_languages > 2) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
        // if birth year, gender, role, language, and "2+" are selected...
        if (birth != 0 && gender != 0 && role != 0 && language != 0 && langValue == 2) {
          // clear the popup content in the output array
          for (x = 0; x < output.length; x++) {
            output[x].writerPop.length = 0;
          };
          // clear the output array
          output.length = 0;
          // iterate through the geojson properties array to compile cumulative lists of multilingual writers for the selected gender, role, language, and birth year
          cumulativeMultilingualProps.forEach(function(item) {
            // if the min_year property is less than or equal to the updateYear variable
            if (updateYear >= item.min_year) {
              // collect by country name
              var existing = output.filter(function(v, i) {
                return v.country == item.country;
              });
              // check if multilingual writers in the list match the selected gender, role, language, and birth year, and, if so, designate popup content
              if (gender == item.writer_1_gender && [item.writer_1_role_1, item.writer_1_role_2, item.writer_1_role_3, item.writer_1_role_4, item.writer_1_role_5].includes(role) && [item.writer_1_language_1, item.writer_1_language_2, item.writer_1_language_3, item.writer_1_language_4].includes(language) && item.writer_1_languages > 1 && birth == item.writer_1_birth) {
                var popup1 = item.writer_1_popup;
              };
              if (gender == item.writer_2_gender && [item.writer_2_role_1, item.writer_2_role_2, item.writer_2_role_3, item.writer_2_role_4, item.writer_2_role_5].includes(role) && [item.writer_2_language_1, item.writer_2_language_2, item.writer_2_language_3, item.writer_2_language_4].includes(language) && item.writer_2_languages > 1 && birth == item.writer_2_birth) {
                var popup2 = item.writer_2_popup;
              };
              if (gender == item.writer_3_gender && [item.writer_3_role_1, item.writer_3_role_2, item.writer_3_role_3, item.writer_3_role_4, item.writer_3_role_5].includes(role) && [item.writer_3_language_1, item.writer_3_language_2, item.writer_3_language_3, item.writer_3_language_4].includes(language) && item.writer_3_languages > 1 && birth == item.writer_3_birth) {
                var popup3 = item.writer_3_popup;
              };
              if (gender == item.writer_4_gender && [item.writer_4_role_1, item.writer_4_role_2, item.writer_4_role_3, item.writer_4_role_4, item.writer_4_role_5].includes(role) && [item.writer_4_language_1, item.writer_4_language_2, item.writer_4_language_3, item.writer_4_language_4].includes(language) && item.writer_4_languages > 1 && birth == item.writer_4_birth) {
                var popup4 = item.writer_4_popup;
              };
              if (gender == item.writer_5_gender && [item.writer_5_role_1, item.writer_5_role_2, item.writer_5_role_3, item.writer_5_role_4, item.writer_5_role_5].includes(role) && [item.writer_5_language_1, item.writer_5_language_2, item.writer_5_language_3, item.writer_5_language_4].includes(language) && item.writer_5_languages > 1 && birth == item.writer_5_birth) {
                var popup5 = item.writer_5_popup;
              };
              // concatenate all cumulative multilingual writers for the selected gender, role, language, and birth year in one property
              if (existing.length) {
                var existingIndex = output.indexOf(existing[0]);
                output[existingIndex].writerPop = (output[existingIndex].writerPop.concat(popup1).concat(popup2).concat(popup3).concat(popup4).concat(popup5)).filter(Boolean);
              } else {
                if (typeof item.writer_1_popup == 'string' && typeof item.writer_2_popup == 'string' && typeof item.writer_3_popup == 'string' && typeof item.writer_4_popup == 'string' && typeof item.writer_5_popup == 'string')
                  item.writerPop = [item.writerPop];
                item.writer_1_popup = [item.writer_1_popup];
                item.writer_2_popup = [item.writer_2_popup];
                item.writer_3_popup = [item.writer_3_popup];
                item.writer_4_popup = [item.writer_4_popup];
                item.writer_5_popup = [item.writer_5_popup];
                // push to output array
                output.push(item)
              }
            };
          });
          // ADD FIRST YEAR CONTENT
          // loop through the output
          for (x = 0; x < output.length; x++) {
            // for the first year, if the multilingual writer's gender, role, language, and birth year equal the selection, add the writer's popup content to the front of the writerPop property
            if (gender == output[x].writer_1_gender && [output[x].writer_1_role_1, output[x].writer_1_role_2, output[x].writer_1_role_3, output[x].writer_1_role_4, output[x].writer_1_role_5].includes(role) && [output[x].writer_1_language_1, output[x].writer_1_language_2, output[x].writer_1_language_3, output[x].writer_1_language_4].includes(language) && output[x].writer_1_languages > 1 && birth == output[x].writer_1_birth) {
              var extraPopup1 = output[x].writer_1_popup;
            } else {
              var extraPopup1 = [""];
            };
            if (gender == output[x].writer_2_gender && [output[x].writer_2_role_1, output[x].writer_2_role_2, output[x].writer_2_role_3, output[x].writer_2_role_4, output[x].writer_2_role_5].includes(role) && [output[x].writer_2_language_1, output[x].writer_2_language_2, output[x].writer_2_language_3, output[x].writer_2_language_4].includes(language) && output[x].writer_2_languages > 1 && birth == output[x].writer_2_birth) {
              var extraPopup2 = output[x].writer_2_popup;
            } else {
              var extraPopup2 = [""];
            };
            if (gender == output[x].writer_3_gender && [output[x].writer_3_role_1, output[x].writer_3_role_2, output[x].writer_3_role_3, output[x].writer_3_role_4, output[x].writer_3_role_5].includes(role) && [output[x].writer_3_language_1, output[x].writer_3_language_2, output[x].writer_3_language_3, output[x].writer_3_language_4].includes(language) && output[x].writer_3_languages > 1 && birth == output[x].writer_3_birth) {
              var extraPopup3 = output[x].writer_3_popup;
            } else {
              var extraPopup3 = [""];
            };
            if (gender == output[x].writer_4_gender && [output[x].writer_4_role_1, output[x].writer_4_role_2, output[x].writer_4_role_3, output[x].writer_4_role_4, output[x].writer_4_role_5].includes(role) && [output[x].writer_4_language_1, output[x].writer_4_language_2, output[x].writer_4_language_3, output[x].writer_4_language_4].includes(language) && output[x].writer_4_languages > 1 && birth == output[x].writer_4_birth) {
              var extraPopup4 = output[x].writer_4_popup;
            } else {
              var extraPopup4 = [""];
            };
            if (gender == output[x].writer_5_gender && [output[x].writer_5_role_1, output[x].writer_5_role_2, output[x].writer_5_role_3, output[x].writer_5_role_4, output[x].writer_5_role_5].includes(role) && [output[x].writer_5_language_1, output[x].writer_5_language_2, output[x].writer_5_language_3, output[x].writer_5_language_4].includes(language) && output[x].writer_5_languages > 1 && birth == output[x].writer_5_birth) {
              var extraPopup5 = output[x].writer_5_popup;
            } else {
              var extraPopup5 = [""];
            };
            // redefine the writerPop property as follows...
            output[x].writerPop = (extraPopup1.concat(extraPopup2).concat(extraPopup3).concat(extraPopup4).concat(extraPopup5)).filter(Boolean).concat(output[x].writerPop);
          };
        };
      };

      // for each layer in cumulativePart...
      cumulativePart.eachLayer(function(layer) {

        // define properties
        var props = layer.feature.properties;

        /* NO LONGER NEEDED */
        // define the current cumulative popup content (counts only unique writers)
        //var cumulativePopup = props.popup_cumulative;
        // count all writers in this list (including writers who returned for more that one year)
        //var writerCount = cumulativePopup.split("</a>").length - 1;
        // get the string between ";(" and ")</b>"
        //var rx = new RegExp(";([\\d\\D]*?)</b>", "g");
        // replace this section with the new writer count
        //var newCumulativePopup = cumulativePopup.replace(rx, ";(" + writerCount + ")</b>");

        // define circle radius with a formula based on...
        //var radius = calcRadius(Number(props.writer_total_cumulative)); // cumulative writer totals
        //var radius = calcRadius(Number(writerCount)); // cumulative writer totals
        /* END NO LONGER NEEDED */

        var annualRadius = calcRadius(Number(props.writer_total_year)); // annual writer totals
        var annualMultiRadius = calcRadius(Number(props.multilingual_writer_total_year)); // annual multilingual writer totals;
        //var cumulativeMultiRadius = calcRadius(Number(props.multilingual_writer_total_cumulative)); // cumulative multilingual writer totals;
//CUMULATIVE MONOLINGUAL
        // define year conditions for cumulative and annual cases
        if (countValue == "cumulative") {
          var dataYear = updateYear >= props.min_year && updateYear <= props.max_year;
          // bind the cumulative popup
          //layer.bindPopup(props.popup_cumulative, {

          /* TESTING */
          // iterate through the output array
          for (x = 0; x < output.length; x++) {
            // if the layer country property equals the output country property...
            if (props.country === output[x].country) {
              // count all writers (including writers who returned for more that one year)
              var writerCount = output[x].writerPop.join("").split("</a>").length - 1;
              var radius = calcRadius(Number(writerCount)); // feed it the cumulative writer totals
              // set the newCumulativePopup property to the following
              var newCumulativePopup = "<b>" + props.country + "&nbsp;(" + writerCount + ")</b><hr />" + output[x].writerPop.join("");
            };
          };
          /* END OF TESTING */

          layer.bindPopup(newCumulativePopup, {
            maxHeight: 300,
            maxWidth: 350
          });
        };
        if (countValue == "annual") {
          var dataYear = updateYear == props.min_year;
          // bind the annual popup
          layer.bindPopup(props.popup_year, {
            maxHeight: 300,
            maxWidth: 350
          });
        };

        // define annual popup content for multilingual writers
        if (props.writer_1_languages >= 2) {
          var multiPopup_1 = props.writer_1_popup;
          var multiCount_1 = 1;
        } else {
          var multiPopup_1 = "";
          var multiCount_1 = 0;
        }
        if (props.writer_2_languages >= 2) {
          var multiPopup_2 = props.writer_2_popup;
          var multiCount_2 = 1;
        } else {
          var multiPopup_2 = "";
          var multiCount_2 = 0;
        }
        if (props.writer_3_languages >= 2) {
          var multiPopup_3 = props.writer_3_popup;
          var multiCount_3 = 1;
        } else {
          var multiPopup_3 = "";
          var multiCount_3 = 0;
        }
        if (props.writer_4_languages >= 2) {
          var multiPopup_4 = props.writer_4_popup;
          var multiCount_4 = 1;
        } else {
          var multiPopup_4 = "";
          var multiCount_4 = 0;
        }
        if (props.writer_5_languages >= 2) {
          var multiPopup_5 = props.writer_5_popup;
          var multiCount_5 = 1;
        } else {
          var multiPopup_5 = "";
          var multiCount_5 = 0;
        }

        // count the total number of multilingual writers from each county in each year
        var annualMultiCount = multiCount_1 + multiCount_2 + multiCount_3 + multiCount_4 + multiCount_5;
        // define the annual multilingual popup content
        var annualMultiPopup = "<b>" + props.country + "&nbsp;(" + annualMultiCount + ")</b><hr />" + multiPopup_1 + multiPopup_2 + multiPopup_3 + multiPopup_4 + multiPopup_5;

        if (countValue == "annual" && langValue == 2) {
          // bind the annual multilingual popup
          layer.bindPopup(annualMultiPopup, {
            maxHeight: 300,
            maxWidth: 350
          });
        };
//CUMULATIVE MULTILINGUAL
        // if "cumulative" is selected
        if (countValue == "cumulative") {
          // if "2+" is selected
          if (langValue == 2) {
            // iterate through the output array
            for (x = 0; x < output.length; x++) {
              // if the layer country property equals the output country property...
              if (props.country === output[x].country) {
                // count all multilingual writers (including writers who returned for more that one year)
                var cumulativeMultiCount = output[x].writerPop.join("").split("</a>").length - 1;
                var cumulativeMultiRadius = calcRadius(Number(cumulativeMultiCount)); // feed it the cumulative multilingual writer totals
                // set the cumulativeMultiPopup property to the following
                //var cumulativeMultiPopup = "<b>" + props.country + "&nbsp;(" + props.multilingual_writer_total_cumulative + ")</b><hr />" + output[x].writerPop.join("");
                var cumulativeMultiPopup = "<b>" + props.country + "&nbsp;(" + cumulativeMultiCount + ")</b><hr />" + output[x].writerPop.join("");
              };
            };
            // bind the cumulative multilingual popup
            layer.bindPopup(cumulativeMultiPopup, {
              maxHeight: 300,
              maxWidth: 350
            });
          };

          // if a language is selected
          if (language != 0) {
            // iterate through the output array
            for (x = 0; x < output.length; x++) {
              // if the layer country property equals the output country property...
              if (props.country === output[x].country) {
                // set the cumulativeWriterLangCount property to the following...
                if (output[x].writerPop == "") {
                  var cumulativeWriterLangCount = 0;
                } else {
                  var cumulativeWriterLangCount = output[x].writerPop.length;
                };
                // set the cumulativeLangPopup property to the following...
                var cumulativeLangPopup = "<b>" + props.country + "&nbsp;(" + cumulativeWriterLangCount + ")</b><hr />" + output[x].writerPop.join("");
              };
            };
            // bind the cumulative language popup
            layer.bindPopup(cumulativeLangPopup, {
              maxHeight: 300,
              maxWidth: 350
            });
            // calculate a radius for cumulative writers by language
            var cumulativeWriterLangRadius = calcRadius(Number(cumulativeWriterLangCount));
          };

          // if a role is selected...
          if (role != 0) {
            // iterate through the output array
            for (x = 0; x < output.length; x++) {
              // if the layer country property equals the output country property...
              if (props.country === output[x].country) {
                // set the cumulativeWriterRoleCount property to the following...
                if (output[x].writerPop == "") {
                  var cumulativeWriterRoleCount = 0;
                } else {
                  var cumulativeWriterRoleCount = output[x].writerPop.length;
                };
                // set the cumulativeRolePopup property to the following...
                var cumulativeRolePopup = "<b>" + props.country + "&nbsp;(" + cumulativeWriterRoleCount + ")</b><hr />" + output[x].writerPop.join("");
              };
            };
            // bind the cumulative role popup
            layer.bindPopup(cumulativeRolePopup, {
              maxHeight: 300,
              maxWidth: 350
            });
            // calculate a radius for cumulative writers by role
            var cumulativeWriterRoleRadius = calcRadius(Number(cumulativeWriterRoleCount));
          };

          // if a gender is selected...
          if (gender != 0) {
            // iterate through the output array
            for (x = 0; x < output.length; x++) {
              // if the layer country property equals the output country property...
              if (props.country === output[x].country) {
                // set the cumulativeWriterGenCount property to the following...
                if (output[x].writerPop == "") {
                  var cumulativeWriterGenCount = 0;
                } else {
                  var cumulativeWriterGenCount = output[x].writerPop.length;
                };
                // set the cumulativeGenPopup property to the following...
                var cumulativeGenPopup = "<b>" + props.country + "&nbsp;(" + cumulativeWriterGenCount + ")</b><hr />" + output[x].writerPop.join("");
              };
            };
            // bind the cumulative gender popup
            layer.bindPopup(cumulativeGenPopup, {
              maxHeight: 300,
              maxWidth: 350
            });
            // calculate a radius for cumulative writers by gender
            var cumulativeWriterGenRadius = calcRadius(Number(cumulativeWriterGenCount));
          };

          // if a birth year is selected...
          if (birth != 0) {
            // iterate through the output array
            for (x = 0; x < output.length; x++) {
              // if the layer country property equals the output country property...
              if (props.country === output[x].country) {
                // set the cumulativeWriterBirthCount property to the following...
                if (output[x].writerPop == "") {
                  var cumulativeWriterBirthCount = 0;
                } else {
                  var cumulativeWriterBirthCount = output[x].writerPop.length;
                };
                // set the cumulativeBirthPopup property to the following...
                var cumulativeBirthPopup = "<b>" + props.country + "&nbsp;(" + cumulativeWriterBirthCount + ")</b><hr />" + output[x].writerPop.join("");
              };
            };
            // bind the cumulative birth year popup
            layer.bindPopup(cumulativeBirthPopup, {
              maxHeight: 300,
              maxWidth: 350
            });
            // calculate a radius for cumulative writers by birth year
            var cumulativeWriterBirthRadius = calcRadius(Number(cumulativeWriterBirthCount));
          };

        };

        // ANNUAL WRITER LANGUAGE CONDITIONS
        if (countValue == "annual" && language != 0) {
          // for language used by individual year, gather popup content
          if (language == props.writer_1_language_1 && dataYear) {
            var annualWriter1Lang1 = props.writer_1_popup;
            var annualWriter1Lang1Count = 1;
          } else {
            var annualWriter1Lang1 = "";
            var annualWriter1Lang1Count = 0;
          }
          if (language == props.writer_1_language_2 && dataYear) {
            var annualWriter1Lang2 = props.writer_1_popup;
            var annualWriter1Lang2Count = 1;
          } else {
            var annualWriter1Lang2 = "";
            var annualWriter1Lang2Count = 0;
          }
          if (language == props.writer_1_language_3 && dataYear) {
            var annualWriter1Lang3 = props.writer_1_popup;
            var annualWriter1Lang3Count = 1;
          } else {
            var annualWriter1Lang3 = "";
            var annualWriter1Lang3Count = 0;
          }
          if (language == props.writer_1_language_4 && dataYear) {
            var annualWriter1Lang4 = props.writer_1_popup;
            var annualWriter1Lang4Count = 1;
          } else {
            var annualWriter1Lang4 = "";
            var annualWriter1Lang4Count = 0;
          }
          if (language == props.writer_2_language_1 && dataYear) {
            var annualWriter2Lang1 = props.writer_2_popup;
            var annualWriter2Lang1Count = 1;
          } else {
            var annualWriter2Lang1 = "";
            var annualWriter2Lang1Count = 0;
          }
          if (language == props.writer_2_language_2 && dataYear) {
            var annualWriter2Lang2 = props.writer_2_popup;
            var annualWriter2Lang2Count = 1;
          } else {
            var annualWriter2Lang2 = "";
            var annualWriter2Lang2Count = 0;
          }
          if (language == props.writer_2_language_3 && dataYear) {
            var annualWriter2Lang3 = props.writer_2_popup;
            var annualWriter2Lang3Count = 1;
          } else {
            var annualWriter2Lang3 = "";
            var annualWriter2Lang3Count = 0;
          }
          if (language == props.writer_2_language_4 && dataYear) {
            var annualWriter2Lang4 = props.writer_2_popup;
            var annualWriter2Lang4Count = 1;
          } else {
            var annualWriter2Lang4 = "";
            var annualWriter2Lang4Count = 0;
          }
          if (language == props.writer_3_language_1 && dataYear) {
            var annualWriter3Lang1 = props.writer_3_popup;
            var annualWriter3Lang1Count = 1;
          } else {
            var annualWriter3Lang1 = "";
            var annualWriter3Lang1Count = 0;
          }
          if (language == props.writer_3_language_2 && dataYear) {
            var annualWriter3Lang2 = props.writer_3_popup;
            var annualWriter3Lang2Count = 1;
          } else {
            var annualWriter3Lang2 = "";
            var annualWriter3Lang2Count = 0;
          }
          if (language == props.writer_3_language_3 && dataYear) {
            var annualWriter3Lang3 = props.writer_3_popup;
            var annualWriter3Lang3Count = 1;
          } else {
            var annualWriter3Lang3 = "";
            var annualWriter3Lang3Count = 0;
          }
          if (language == props.writer_3_language_4 && dataYear) {
            var annualWriter3Lang4 = props.writer_3_popup;
            var annualWriter3Lang4Count = 1;
          } else {
            var annualWriter3Lang4 = "";
            var annualWriter3Lang4Count = 0;
          }
          if (language == props.writer_4_language_1 && dataYear) {
            var annualWriter4Lang1 = props.writer_4_popup;
            var annualWriter4Lang1Count = 1;
          } else {
            var annualWriter4Lang1 = "";
            var annualWriter4Lang1Count = 0;
          }
          if (language == props.writer_4_language_2 && dataYear) {
            var annualWriter4Lang2 = props.writer_4_popup;
            var annualWriter4Lang2Count = 1;
          } else {
            var annualWriter4Lang2 = "";
            var annualWriter4Lang2Count = 0;
          }
          if (language == props.writer_4_language_3 && dataYear) {
            var annualWriter4Lang3 = props.writer_4_popup;
            var annualWriter4Lang3Count = 1;
          } else {
            var annualWriter4Lang3 = "";
            var annualWriter4Lang3Count = 0;
          }
          if (language == props.writer_4_language_4 && dataYear) {
            var annualWriter4Lang4 = props.writer_4_popup;
            var annualWriter4Lang4Count = 1;
          } else {
            var annualWriter4Lang4 = "";
            var annualWriter4Lang4Count = 0;
          }
          if (language == props.writer_5_language_1 && dataYear) {
            var annualWriter5Lang1 = props.writer_5_popup;
            var annualWriter5Lang1Count = 1;
          } else {
            var annualWriter5Lang1 = "";
            var annualWriter5Lang1Count = 0;
          }
          if (language == props.writer_5_language_2 && dataYear) {
            var annualWriter5Lang2 = props.writer_5_popup;
            var annualWriter5Lang2Count = 1;
          } else {
            var annualWriter5Lang2 = "";
            var annualWriter5Lang2Count = 0;
          }
          if (language == props.writer_5_language_3 && dataYear) {
            var annualWriter5Lang3 = props.writer_5_popup;
            var annualWriter5Lang3Count = 1;
          } else {
            var annualWriter5Lang3 = "";
            var annualWriter5Lang3Count = 0;
          }
          if (language == props.writer_5_language_4 && dataYear) {
            var annualWriter5Lang4 = props.writer_5_popup;
            var annualWriter5Lang4Count = 1;
          } else {
            var annualWriter5Lang4 = "";
            var annualWriter5Lang4Count = 0;
          }

          // if "2+" is selected...
          if (langValue == 2) {
            // for language used by multilingual writers by individual year, gather popup content
            if (language == props.writer_1_language_1 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Lang1 = props.writer_1_popup;
              var annualWriter1Lang1Count = 1;
            } else {
              var annualWriter1Lang1 = "";
              var annualWriter1Lang1Count = 0;
            }
            if (language == props.writer_1_language_2 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Lang2 = props.writer_1_popup;
              var annualWriter1Lang2Count = 1;
            } else {
              var annualWriter1Lang2 = "";
              var annualWriter1Lang2Count = 0;
            }
            if (language == props.writer_1_language_3 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Lang3 = props.writer_1_popup;
              var annualWriter1Lang3Count = 1;
            } else {
              var annualWriter1Lang3 = "";
              var annualWriter1Lang3Count = 0;
            }
            if (language == props.writer_1_language_4 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Lang4 = props.writer_1_popup;
              var annualWriter1Lang4Count = 1;
            } else {
              var annualWriter1Lang4 = "";
              var annualWriter1Lang4Count = 0;
            }
            if (language == props.writer_2_language_1 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Lang1 = props.writer_2_popup;
              var annualWriter2Lang1Count = 1;
            } else {
              var annualWriter2Lang1 = "";
              var annualWriter2Lang1Count = 0;
            }
            if (language == props.writer_2_language_2 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Lang2 = props.writer_2_popup;
              var annualWriter2Lang2Count = 1;
            } else {
              var annualWriter2Lang2 = "";
              var annualWriter2Lang2Count = 0;
            }
            if (language == props.writer_2_language_3 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Lang3 = props.writer_2_popup;
              var annualWriter2Lang3Count = 1;
            } else {
              var annualWriter2Lang3 = "";
              var annualWriter2Lang3Count = 0;
            }
            if (language == props.writer_2_language_4 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Lang4 = props.writer_2_popup;
              var annualWriter2Lang4Count = 1;
            } else {
              var annualWriter2Lang4 = "";
              var annualWriter2Lang4Count = 0;
            }
            if (language == props.writer_3_language_1 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Lang1 = props.writer_3_popup;
              var annualWriter3Lang1Count = 1;
            } else {
              var annualWriter3Lang1 = "";
              var annualWriter3Lang1Count = 0;
            }
            if (language == props.writer_3_language_2 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Lang2 = props.writer_3_popup;
              var annualWriter3Lang2Count = 1;
            } else {
              var annualWriter3Lang2 = "";
              var annualWriter3Lang2Count = 0;
            }
            if (language == props.writer_3_language_3 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Lang3 = props.writer_3_popup;
              var annualWriter3Lang3Count = 1;
            } else {
              var annualWriter3Lang3 = "";
              var annualWriter3Lang3Count = 0;
            }
            if (language == props.writer_3_language_4 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Lang4 = props.writer_3_popup;
              var annualWriter3Lang4Count = 1;
            } else {
              var annualWriter3Lang4 = "";
              var annualWriter3Lang4Count = 0;
            }
            if (language == props.writer_4_language_1 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Lang1 = props.writer_4_popup;
              var annualWriter4Lang1Count = 1;
            } else {
              var annualWriter4Lang1 = "";
              var annualWriter4Lang1Count = 0;
            }
            if (language == props.writer_4_language_2 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Lang2 = props.writer_4_popup;
              var annualWriter4Lang2Count = 1;
            } else {
              var annualWriter4Lang2 = "";
              var annualWriter4Lang2Count = 0;
            }
            if (language == props.writer_4_language_3 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Lang3 = props.writer_4_popup;
              var annualWriter4Lang3Count = 1;
            } else {
              var annualWriter4Lang3 = "";
              var annualWriter4Lang3Count = 0;
            }
            if (language == props.writer_4_language_4 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Lang4 = props.writer_4_popup;
              var annualWriter4Lang4Count = 1;
            } else {
              var annualWriter4Lang4 = "";
              var annualWriter4Lang4Count = 0;
            }
            if (language == props.writer_5_language_1 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Lang1 = props.writer_5_popup;
              var annualWriter5Lang1Count = 1;
            } else {
              var annualWriter5Lang1 = "";
              var annualWriter5Lang1Count = 0;
            }
            if (language == props.writer_5_language_2 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Lang2 = props.writer_5_popup;
              var annualWriter5Lang2Count = 1;
            } else {
              var annualWriter5Lang2 = "";
              var annualWriter5Lang2Count = 0;
            }
            if (language == props.writer_5_language_3 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Lang3 = props.writer_5_popup;
              var annualWriter5Lang3Count = 1;
            } else {
              var annualWriter5Lang3 = "";
              var annualWriter5Lang3Count = 0;
            }
            if (language == props.writer_5_language_4 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Lang4 = props.writer_5_popup;
              var annualWriter5Lang4Count = 1;
            } else {
              var annualWriter5Lang4 = "";
              var annualWriter5Lang4Count = 0;
            }
          };

          // if a gender is selected...
          if (gender != 0) {
            // for language used by writers by gender, gather popup content
            if (language == props.writer_1_language_1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang1 = props.writer_1_popup;
              var annualWriter1Lang1Count = 1;
            } else {
              var annualWriter1Lang1 = "";
              var annualWriter1Lang1Count = 0;
            }
            if (language == props.writer_1_language_2 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang2 = props.writer_1_popup;
              var annualWriter1Lang2Count = 1;
            } else {
              var annualWriter1Lang2 = "";
              var annualWriter1Lang2Count = 0;
            }
            if (language == props.writer_1_language_3 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang3 = props.writer_1_popup;
              var annualWriter1Lang3Count = 1;
            } else {
              var annualWriter1Lang3 = "";
              var annualWriter1Lang3Count = 0;
            }
            if (language == props.writer_1_language_4 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang4 = props.writer_1_popup;
              var annualWriter1Lang4Count = 1;
            } else {
              var annualWriter1Lang4 = "";
              var annualWriter1Lang4Count = 0;
            }
            if (language == props.writer_2_language_1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang1 = props.writer_2_popup;
              var annualWriter2Lang1Count = 1;
            } else {
              var annualWriter2Lang1 = "";
              var annualWriter2Lang1Count = 0;
            }
            if (language == props.writer_2_language_2 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang2 = props.writer_2_popup;
              var annualWriter2Lang2Count = 1;
            } else {
              var annualWriter2Lang2 = "";
              var annualWriter2Lang2Count = 0;
            }
            if (language == props.writer_2_language_3 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang3 = props.writer_2_popup;
              var annualWriter2Lang3Count = 1;
            } else {
              var annualWriter2Lang3 = "";
              var annualWriter2Lang3Count = 0;
            }
            if (language == props.writer_2_language_4 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang4 = props.writer_2_popup;
              var annualWriter2Lang4Count = 1;
            } else {
              var annualWriter2Lang4 = "";
              var annualWriter2Lang4Count = 0;
            }
            if (language == props.writer_3_language_1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang1 = props.writer_3_popup;
              var annualWriter3Lang1Count = 1;
            } else {
              var annualWriter3Lang1 = "";
              var annualWriter3Lang1Count = 0;
            }
            if (language == props.writer_3_language_2 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang2 = props.writer_3_popup;
              var annualWriter3Lang2Count = 1;
            } else {
              var annualWriter3Lang2 = "";
              var annualWriter3Lang2Count = 0;
            }
            if (language == props.writer_3_language_3 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang3 = props.writer_3_popup;
              var annualWriter3Lang3Count = 1;
            } else {
              var annualWriter3Lang3 = "";
              var annualWriter3Lang3Count = 0;
            }
            if (language == props.writer_3_language_4 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang4 = props.writer_3_popup;
              var annualWriter3Lang4Count = 1;
            } else {
              var annualWriter3Lang4 = "";
              var annualWriter3Lang4Count = 0;
            }
            if (language == props.writer_4_language_1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang1 = props.writer_4_popup;
              var annualWriter4Lang1Count = 1;
            } else {
              var annualWriter4Lang1 = "";
              var annualWriter4Lang1Count = 0;
            }
            if (language == props.writer_4_language_2 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang2 = props.writer_4_popup;
              var annualWriter4Lang2Count = 1;
            } else {
              var annualWriter4Lang2 = "";
              var annualWriter4Lang2Count = 0;
            }
            if (language == props.writer_4_language_3 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang3 = props.writer_4_popup;
              var annualWriter4Lang3Count = 1;
            } else {
              var annualWriter4Lang3 = "";
              var annualWriter4Lang3Count = 0;
            }
            if (language == props.writer_4_language_4 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang4 = props.writer_4_popup;
              var annualWriter4Lang4Count = 1;
            } else {
              var annualWriter4Lang4 = "";
              var annualWriter4Lang4Count = 0;
            }
            if (language == props.writer_5_language_1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang1 = props.writer_5_popup;
              var annualWriter5Lang1Count = 1;
            } else {
              var annualWriter5Lang1 = "";
              var annualWriter5Lang1Count = 0;
            }
            if (language == props.writer_5_language_2 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang2 = props.writer_5_popup;
              var annualWriter5Lang2Count = 1;
            } else {
              var annualWriter5Lang2 = "";
              var annualWriter5Lang2Count = 0;
            }
            if (language == props.writer_5_language_3 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang3 = props.writer_5_popup;
              var annualWriter5Lang3Count = 1;
            } else {
              var annualWriter5Lang3 = "";
              var annualWriter5Lang3Count = 0;
            }
            if (language == props.writer_5_language_4 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang4 = props.writer_5_popup;
              var annualWriter5Lang4Count = 1;
            } else {
              var annualWriter5Lang4 = "";
              var annualWriter5Lang4Count = 0;
            }
          };

          // if "2+" and a gender is selected...
          if (langValue == 2 && gender != 0) {
            // for language used by multilingual writers by individual year, gather popup content
            if (language == props.writer_1_language_1 && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang1 = props.writer_1_popup;
              var annualWriter1Lang1Count = 1;
            } else {
              var annualWriter1Lang1 = "";
              var annualWriter1Lang1Count = 0;
            }
            if (language == props.writer_1_language_2 && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang2 = props.writer_1_popup;
              var annualWriter1Lang2Count = 1;
            } else {
              var annualWriter1Lang2 = "";
              var annualWriter1Lang2Count = 0;
            }
            if (language == props.writer_1_language_3 && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang3 = props.writer_1_popup;
              var annualWriter1Lang3Count = 1;
            } else {
              var annualWriter1Lang3 = "";
              var annualWriter1Lang3Count = 0;
            }
            if (language == props.writer_1_language_4 && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang4 = props.writer_1_popup;
              var annualWriter1Lang4Count = 1;
            } else {
              var annualWriter1Lang4 = "";
              var annualWriter1Lang4Count = 0;
            }
            if (language == props.writer_2_language_1 && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang1 = props.writer_2_popup;
              var annualWriter2Lang1Count = 1;
            } else {
              var annualWriter2Lang1 = "";
              var annualWriter2Lang1Count = 0;
            }
            if (language == props.writer_2_language_2 && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang2 = props.writer_2_popup;
              var annualWriter2Lang2Count = 1;
            } else {
              var annualWriter2Lang2 = "";
              var annualWriter2Lang2Count = 0;
            }
            if (language == props.writer_2_language_3 && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang3 = props.writer_2_popup;
              var annualWriter2Lang3Count = 1;
            } else {
              var annualWriter2Lang3 = "";
              var annualWriter2Lang3Count = 0;
            }
            if (language == props.writer_2_language_4 && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang4 = props.writer_2_popup;
              var annualWriter2Lang4Count = 1;
            } else {
              var annualWriter2Lang4 = "";
              var annualWriter2Lang4Count = 0;
            }
            if (language == props.writer_3_language_1 && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang1 = props.writer_3_popup;
              var annualWriter3Lang1Count = 1;
            } else {
              var annualWriter3Lang1 = "";
              var annualWriter3Lang1Count = 0;
            }
            if (language == props.writer_3_language_2 && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang2 = props.writer_3_popup;
              var annualWriter3Lang2Count = 1;
            } else {
              var annualWriter3Lang2 = "";
              var annualWriter3Lang2Count = 0;
            }
            if (language == props.writer_3_language_3 && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang3 = props.writer_3_popup;
              var annualWriter3Lang3Count = 1;
            } else {
              var annualWriter3Lang3 = "";
              var annualWriter3Lang3Count = 0;
            }
            if (language == props.writer_3_language_4 && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang4 = props.writer_3_popup;
              var annualWriter3Lang4Count = 1;
            } else {
              var annualWriter3Lang4 = "";
              var annualWriter3Lang4Count = 0;
            }
            if (language == props.writer_4_language_1 && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang1 = props.writer_4_popup;
              var annualWriter4Lang1Count = 1;
            } else {
              var annualWriter4Lang1 = "";
              var annualWriter4Lang1Count = 0;
            }
            if (language == props.writer_4_language_2 && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang2 = props.writer_4_popup;
              var annualWriter4Lang2Count = 1;
            } else {
              var annualWriter4Lang2 = "";
              var annualWriter4Lang2Count = 0;
            }
            if (language == props.writer_4_language_3 && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang3 = props.writer_4_popup;
              var annualWriter4Lang3Count = 1;
            } else {
              var annualWriter4Lang3 = "";
              var annualWriter4Lang3Count = 0;
            }
            if (language == props.writer_4_language_4 && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang4 = props.writer_4_popup;
              var annualWriter4Lang4Count = 1;
            } else {
              var annualWriter4Lang4 = "";
              var annualWriter4Lang4Count = 0;
            }
            if (language == props.writer_5_language_1 && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang1 = props.writer_5_popup;
              var annualWriter5Lang1Count = 1;
            } else {
              var annualWriter5Lang1 = "";
              var annualWriter5Lang1Count = 0;
            }
            if (language == props.writer_5_language_2 && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang2 = props.writer_5_popup;
              var annualWriter5Lang2Count = 1;
            } else {
              var annualWriter5Lang2 = "";
              var annualWriter5Lang2Count = 0;
            }
            if (language == props.writer_5_language_3 && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang3 = props.writer_5_popup;
              var annualWriter5Lang3Count = 1;
            } else {
              var annualWriter5Lang3 = "";
              var annualWriter5Lang3Count = 0;
            }
            if (language == props.writer_5_language_4 && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang4 = props.writer_5_popup;
              var annualWriter5Lang4Count = 1;
            } else {
              var annualWriter5Lang4 = "";
              var annualWriter5Lang4Count = 0;
            }
          };

          // if multilingual, role, and gender are selected...
          if (langValue == 2 && role != 0 && gender != 0) {
            if ([props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Lang = props.writer_1_popup;
              var annualWriter1LangCount = 1;
            } else {
              var annualWriter1Lang = "";
              var annualWriter1LangCount = 0;
            }
            if ([props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Lang = props.writer_2_popup;
              var annualWriter2LangCount = 1;
            } else {
              var annualWriter2Lang = "";
              var annualWriter2LangCount = 0;
            }
            if ([props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Lang = props.writer_3_popup;
              var annualWriter3LangCount = 1;
            } else {
              var annualWriter3Lang = "";
              var annualWriter3LangCount = 0;
            }
            if ([props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Lang = props.writer_4_popup;
              var annualWriter4LangCount = 1;
            } else {
              var annualWriter4Lang = "";
              var annualWriter4LangCount = 0;
            }
            if ([props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Lang = props.writer_5_popup;
              var annualWriter5LangCount = 1;
            } else {
              var annualWriter5Lang = "";
              var annualWriter5LangCount = 0;
            }
          };

          // sum the number of writers per country who speak the chosen language
          var annualWriterLangCount = annualWriter1Lang1Count + annualWriter1Lang2Count + annualWriter1Lang3Count + annualWriter1Lang4Count + annualWriter2Lang1Count + annualWriter2Lang2Count + annualWriter2Lang3Count + annualWriter2Lang4Count + annualWriter3Lang1Count + annualWriter3Lang2Count + annualWriter3Lang3Count + annualWriter3Lang4Count + annualWriter4Lang1Count + annualWriter4Lang2Count + annualWriter4Lang3Count + annualWriter4Lang4Count + annualWriter5Lang1Count + annualWriter5Lang2Count + annualWriter5Lang3Count + annualWriter5Lang4Count;

          // if multilingual, role, and gender are selected...
          if (langValue == 2 && role != 0 && gender != 0) {
            var annualWriterLangCount = annualWriter1LangCount + annualWriter2LangCount + annualWriter3LangCount + annualWriter4LangCount + annualWriter5LangCount;
          };

          // calculate a radius for annual writers by language
          var annualWriterLangRadius = calcRadius(Number(annualWriterLangCount));

          // for language used by individual year, name the popup content, but leave undefined
          var annualWriterLangPopup;

          // for language used by individual year, define the popup content when a country features writers for that language
          if (annualWriterLangCount > 0) {
            annualWriterLangPopup = "<b>" + props.country + "&nbsp;(" + annualWriterLangCount + ")</b><hr />" + annualWriter1Lang1 + annualWriter1Lang2 + annualWriter1Lang3 + annualWriter1Lang4 + annualWriter2Lang1 + annualWriter2Lang2 + annualWriter2Lang3 + annualWriter2Lang4 + annualWriter3Lang1 + annualWriter3Lang2 + annualWriter3Lang3 + annualWriter3Lang4 + annualWriter4Lang1 + annualWriter4Lang2 + annualWriter4Lang3 + annualWriter4Lang4 + annualWriter5Lang1 + annualWriter5Lang2 + annualWriter5Lang3 + annualWriter5Lang4;
            // if multilingual, role, and gender are selected...
            if (langValue == 2 && role != 0 && gender != 0) {
              annualWriterLangPopup = "<b>" + props.country + "&nbsp;(" + annualWriterLangCount + ")</b><hr />" + annualWriter1Lang + annualWriter2Lang + annualWriter3Lang + annualWriter4Lang + annualWriter5Lang;
            };
          };

          // bind the annual writer popup when a language is selected
          layer.bindPopup(annualWriterLangPopup, {
            maxHeight: 300,
            maxWidth: 350
          });
        };
        // END ANNUAL WRITER LANGUAGE CONDITIONS

        // ANNUAL WRITER ROLE CONDITIONS
        if (countValue == "annual" && role != 0) {
          // for role by individual year, gather popup content
          if (role == props.writer_1_role_1 && dataYear) {
            var annualWriter1Role1 = props.writer_1_popup;
            var annualWriter1Role1Count = 1;
          } else {
            var annualWriter1Role1 = "";
            var annualWriter1Role1Count = 0;
          }
          if (role == props.writer_1_role_2 && dataYear) {
            var annualWriter1Role2 = props.writer_1_popup;
            var annualWriter1Role2Count = 1;
          } else {
            var annualWriter1Role2 = "";
            var annualWriter1Role2Count = 0;
          }
          if (role == props.writer_1_role_3 && dataYear) {
            var annualWriter1Role3 = props.writer_1_popup;
            var annualWriter1Role3Count = 1;
          } else {
            var annualWriter1Role3 = "";
            var annualWriter1Role3Count = 0;
          }
          if (role == props.writer_1_role_4 && dataYear) {
            var annualWriter1Role4 = props.writer_1_popup;
            var annualWriter1Role4Count = 1;
          } else {
            var annualWriter1Role4 = "";
            var annualWriter1Role4Count = 0;
          }
          if (role == props.writer_1_role_5 && dataYear) {
            var annualWriter1Role5 = props.writer_1_popup;
            var annualWriter1Role5Count = 1;
          } else {
            var annualWriter1Role5 = "";
            var annualWriter1Role5Count = 0;
          }
          if (role == props.writer_2_role_1 && dataYear) {
            var annualWriter2Role1 = props.writer_2_popup;
            var annualWriter2Role1Count = 1;
          } else {
            var annualWriter2Role1 = "";
            var annualWriter2Role1Count = 0;
          }
          if (role == props.writer_2_role_2 && dataYear) {
            var annualWriter2Role2 = props.writer_2_popup;
            var annualWriter2Role2Count = 1;
          } else {
            var annualWriter2Role2 = "";
            var annualWriter2Role2Count = 0;
          }
          if (role == props.writer_2_role_3 && dataYear) {
            var annualWriter2Role3 = props.writer_2_popup;
            var annualWriter2Role3Count = 1;
          } else {
            var annualWriter2Role3 = "";
            var annualWriter2Role3Count = 0;
          }
          if (role == props.writer_2_role_4 && dataYear) {
            var annualWriter2Role4 = props.writer_2_popup;
            var annualWriter2Role4Count = 1;
          } else {
            var annualWriter2Role4 = "";
            var annualWriter2Role4Count = 0;
          }
          if (role == props.writer_2_role_5 && dataYear) {
            var annualWriter2Role5 = props.writer_2_popup;
            var annualWriter2Role5Count = 1;
          } else {
            var annualWriter2Role5 = "";
            var annualWriter2Role5Count = 0;
          }
          if (role == props.writer_3_role_1 && dataYear) {
            var annualWriter3Role1 = props.writer_3_popup;
            var annualWriter3Role1Count = 1;
          } else {
            var annualWriter3Role1 = "";
            var annualWriter3Role1Count = 0;
          }
          if (role == props.writer_3_role_2 && dataYear) {
            var annualWriter3Role2 = props.writer_3_popup;
            var annualWriter3Role2Count = 1;
          } else {
            var annualWriter3Role2 = "";
            var annualWriter3Role2Count = 0;
          }
          if (role == props.writer_3_role_3 && dataYear) {
            var annualWriter3Role3 = props.writer_3_popup;
            var annualWriter3Role3Count = 1;
          } else {
            var annualWriter3Role3 = "";
            var annualWriter3Role3Count = 0;
          }
          if (role == props.writer_3_role_4 && dataYear) {
            var annualWriter3Role4 = props.writer_3_popup;
            var annualWriter3Role4Count = 1;
          } else {
            var annualWriter3Role4 = "";
            var annualWriter3Role4Count = 0;
          }
          if (role == props.writer_3_role_5 && dataYear) {
            var annualWriter3Role5 = props.writer_3_popup;
            var annualWriter3Role5Count = 1;
          } else {
            var annualWriter3Role5 = "";
            var annualWriter3Role5Count = 0;
          }
          if (role == props.writer_4_role_1 && dataYear) {
            var annualWriter4Role1 = props.writer_4_popup;
            var annualWriter4Role1Count = 1;
          } else {
            var annualWriter4Role1 = "";
            var annualWriter4Role1Count = 0;
          }
          if (role == props.writer_4_role_2 && dataYear) {
            var annualWriter4Role2 = props.writer_4_popup;
            var annualWriter4Role2Count = 1;
          } else {
            var annualWriter4Role2 = "";
            var annualWriter4Role2Count = 0;
          }
          if (role == props.writer_4_role_3 && dataYear) {
            var annualWriter4Role3 = props.writer_4_popup;
            var annualWriter4Role3Count = 1;
          } else {
            var annualWriter4Role3 = "";
            var annualWriter4Role3Count = 0;
          }
          if (role == props.writer_4_role_4 && dataYear) {
            var annualWriter4Role4 = props.writer_4_popup;
            var annualWriter4Role4Count = 1;
          } else {
            var annualWriter4Role4 = "";
            var annualWriter4Role4Count = 0;
          }
          if (role == props.writer_4_role_5 && dataYear) {
            var annualWriter4Role5 = props.writer_4_popup;
            var annualWriter4Role5Count = 1;
          } else {
            var annualWriter4Role5 = "";
            var annualWriter4Role5Count = 0;
          }
          if (role == props.writer_5_role_1 && dataYear) {
            var annualWriter5Role1 = props.writer_5_popup;
            var annualWriter5Role1Count = 1;
          } else {
            var annualWriter5Role1 = "";
            var annualWriter5Role1Count = 0;
          }
          if (role == props.writer_5_role_2 && dataYear) {
            var annualWriter5Role2 = props.writer_5_popup;
            var annualWriter5Role2Count = 1;
          } else {
            var annualWriter5Role2 = "";
            var annualWriter5Role2Count = 0;
          }
          if (role == props.writer_5_role_3 && dataYear) {
            var annualWriter5Role3 = props.writer_5_popup;
            var annualWriter5Role3Count = 1;
          } else {
            var annualWriter5Role3 = "";
            var annualWriter5Role3Count = 0;
          }
          if (role == props.writer_5_role_4 && dataYear) {
            var annualWriter5Role4 = props.writer_5_popup;
            var annualWriter5Role4Count = 1;
          } else {
            var annualWriter5Role4 = "";
            var annualWriter5Role4Count = 0;
          }
          if (role == props.writer_5_role_5 && dataYear) {
            var annualWriter5Role5 = props.writer_5_popup;
            var annualWriter5Role5Count = 1;
          } else {
            var annualWriter5Role5 = "";
            var annualWriter5Role5Count = 0;
          }

          // if "2+" is selected...
          if (langValue == 2) {
            if (role == props.writer_1_role_1 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Role1 = props.writer_1_popup;
              var annualWriter1Role1Count = 1;
            } else {
              var annualWriter1Role1 = "";
              var annualWriter1Role1Count = 0;
            }
            if (role == props.writer_1_role_2 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Role2 = props.writer_1_popup;
              var annualWriter1Role2Count = 1;
            } else {
              var annualWriter1Role2 = "";
              var annualWriter1Role2Count = 0;
            }
            if (role == props.writer_1_role_3 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Role3 = props.writer_1_popup;
              var annualWriter1Role3Count = 1;
            } else {
              var annualWriter1Role3 = "";
              var annualWriter1Role3Count = 0;
            }
            if (role == props.writer_1_role_4 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Role4 = props.writer_1_popup;
              var annualWriter1Role4Count = 1;
            } else {
              var annualWriter1Role4 = "";
              var annualWriter1Role4Count = 0;
            }
            if (role == props.writer_1_role_5 && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Role5 = props.writer_1_popup;
              var annualWriter1Role5Count = 1;
            } else {
              var annualWriter1Role5 = "";
              var annualWriter1Role5Count = 0;
            }
            if (role == props.writer_2_role_1 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Role1 = props.writer_2_popup;
              var annualWriter2Role1Count = 1;
            } else {
              var annualWriter2Role1 = "";
              var annualWriter2Role1Count = 0;
            }
            if (role == props.writer_2_role_2 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Role2 = props.writer_2_popup;
              var annualWriter2Role2Count = 1;
            } else {
              var annualWriter2Role2 = "";
              var annualWriter2Role2Count = 0;
            }
            if (role == props.writer_2_role_3 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Role3 = props.writer_2_popup;
              var annualWriter2Role3Count = 1;
            } else {
              var annualWriter2Role3 = "";
              var annualWriter2Role3Count = 0;
            }
            if (role == props.writer_2_role_4 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Role4 = props.writer_2_popup;
              var annualWriter2Role4Count = 1;
            } else {
              var annualWriter2Role4 = "";
              var annualWriter2Role4Count = 0;
            }
            if (role == props.writer_2_role_5 && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Role5 = props.writer_2_popup;
              var annualWriter2Role5Count = 1;
            } else {
              var annualWriter2Role5 = "";
              var annualWriter2Role5Count = 0;
            }
            if (role == props.writer_3_role_1 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Role1 = props.writer_3_popup;
              var annualWriter3Role1Count = 1;
            } else {
              var annualWriter3Role1 = "";
              var annualWriter3Role1Count = 0;
            }
            if (role == props.writer_3_role_2 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Role2 = props.writer_3_popup;
              var annualWriter3Role2Count = 1;
            } else {
              var annualWriter3Role2 = "";
              var annualWriter3Role2Count = 0;
            }
            if (role == props.writer_3_role_3 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Role3 = props.writer_3_popup;
              var annualWriter3Role3Count = 1;
            } else {
              var annualWriter3Role3 = "";
              var annualWriter3Role3Count = 0;
            }
            if (role == props.writer_3_role_4 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Role4 = props.writer_3_popup;
              var annualWriter3Role4Count = 1;
            } else {
              var annualWriter3Role4 = "";
              var annualWriter3Role4Count = 0;
            }
            if (role == props.writer_3_role_5 && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Role5 = props.writer_3_popup;
              var annualWriter3Role5Count = 1;
            } else {
              var annualWriter3Role5 = "";
              var annualWriter3Role5Count = 0;
            }
            if (role == props.writer_4_role_1 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Role1 = props.writer_4_popup;
              var annualWriter4Role1Count = 1;
            } else {
              var annualWriter4Role1 = "";
              var annualWriter4Role1Count = 0;
            }
            if (role == props.writer_4_role_2 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Role2 = props.writer_4_popup;
              var annualWriter4Role2Count = 1;
            } else {
              var annualWriter4Role2 = "";
              var annualWriter4Role2Count = 0;
            }
            if (role == props.writer_4_role_3 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Role3 = props.writer_4_popup;
              var annualWriter4Role3Count = 1;
            } else {
              var annualWriter4Role3 = "";
              var annualWriter4Role3Count = 0;
            }
            if (role == props.writer_4_role_4 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Role4 = props.writer_4_popup;
              var annualWriter4Role4Count = 1;
            } else {
              var annualWriter4Role4 = "";
              var annualWriter4Role4Count = 0;
            }
            if (role == props.writer_4_role_5 && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Role5 = props.writer_4_popup;
              var annualWriter4Role5Count = 1;
            } else {
              var annualWriter4Role5 = "";
              var annualWriter4Role5Count = 0;
            }
            if (role == props.writer_5_role_1 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Role1 = props.writer_5_popup;
              var annualWriter5Role1Count = 1;
            } else {
              var annualWriter5Role1 = "";
              var annualWriter5Role1Count = 0;
            }
            if (role == props.writer_5_role_2 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Role2 = props.writer_5_popup;
              var annualWriter5Role2Count = 1;
            } else {
              var annualWriter5Role2 = "";
              var annualWriter5Role2Count = 0;
            }
            if (role == props.writer_5_role_3 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Role3 = props.writer_5_popup;
              var annualWriter5Role3Count = 1;
            } else {
              var annualWriter5Role3 = "";
              var annualWriter5Role3Count = 0;
            }
            if (role == props.writer_5_role_4 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Role4 = props.writer_5_popup;
              var annualWriter5Role4Count = 1;
            } else {
              var annualWriter5Role4 = "";
              var annualWriter5Role4Count = 0;
            }
            if (role == props.writer_5_role_5 && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Role5 = props.writer_5_popup;
              var annualWriter5Role5Count = 1;
            } else {
              var annualWriter5Role5 = "";
              var annualWriter5Role5Count = 0;
            }
          };

          // if a language is selected...
          if (language != 0) {
            if (dataYear && role == props.writer_1_role_1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role1 = props.writer_1_popup;
              var annualWriter1Role1Count = 1;
            } else {
              var annualWriter1Role1 = "";
              var annualWriter1Role1Count = 0;
            }
            if (dataYear && role == props.writer_1_role_2 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role2 = props.writer_1_popup;
              var annualWriter1Role2Count = 1;
            } else {
              var annualWriter1Role2 = "";
              var annualWriter1Role2Count = 0;
            }
            if (dataYear && role == props.writer_1_role_3 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role3 = props.writer_1_popup;
              var annualWriter1Role3Count = 1;
            } else {
              var annualWriter1Role3 = "";
              var annualWriter1Role3Count = 0;
            }
            if (dataYear && role == props.writer_1_role_4 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role4 = props.writer_1_popup;
              var annualWriter1Role4Count = 1;
            } else {
              var annualWriter1Role4 = "";
              var annualWriter1Role4Count = 0;
            }
            if (dataYear && role == props.writer_1_role_5 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role5 = props.writer_1_popup;
              var annualWriter1Role5Count = 1;
            } else {
              var annualWriter1Role5 = "";
              var annualWriter1Role5Count = 0;
            }
            if (dataYear && role == props.writer_2_role_1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role1 = props.writer_2_popup;
              var annualWriter2Role1Count = 1;
            } else {
              var annualWriter2Role1 = "";
              var annualWriter2Role1Count = 0;
            }
            if (dataYear && role == props.writer_2_role_2 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role2 = props.writer_2_popup;
              var annualWriter2Role2Count = 1;
            } else {
              var annualWriter2Role2 = "";
              var annualWriter2Role2Count = 0;
            }
            if (dataYear && role == props.writer_2_role_3 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role3 = props.writer_2_popup;
              var annualWriter2Role3Count = 1;
            } else {
              var annualWriter2Role3 = "";
              var annualWriter2Role3Count = 0;
            }
            if (dataYear && role == props.writer_2_role_4 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role4 = props.writer_2_popup;
              var annualWriter2Role4Count = 1;
            } else {
              var annualWriter2Role4 = "";
              var annualWriter2Role4Count = 0;
            }
            if (dataYear && role == props.writer_2_role_5 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role5 = props.writer_2_popup;
              var annualWriter2Role5Count = 1;
            } else {
              var annualWriter2Role5 = "";
              var annualWriter2Role5Count = 0;
            }
            if (dataYear && role == props.writer_3_role_1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role1 = props.writer_3_popup;
              var annualWriter3Role1Count = 1;
            } else {
              var annualWriter3Role1 = "";
              var annualWriter3Role1Count = 0;
            }
            if (dataYear && role == props.writer_3_role_2 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role2 = props.writer_3_popup;
              var annualWriter3Role2Count = 1;
            } else {
              var annualWriter3Role2 = "";
              var annualWriter3Role2Count = 0;
            }
            if (dataYear && role == props.writer_3_role_3 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role3 = props.writer_3_popup;
              var annualWriter3Role3Count = 1;
            } else {
              var annualWriter3Role3 = "";
              var annualWriter3Role3Count = 0;
            }
            if (dataYear && role == props.writer_3_role_4 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role4 = props.writer_3_popup;
              var annualWriter3Role4Count = 1;
            } else {
              var annualWriter3Role4 = "";
              var annualWriter3Role4Count = 0;
            }
            if (dataYear && role == props.writer_3_role_5 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role5 = props.writer_3_popup;
              var annualWriter3Role5Count = 1;
            } else {
              var annualWriter3Role5 = "";
              var annualWriter3Role5Count = 0;
            }
            if (dataYear && role == props.writer_4_role_1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role1 = props.writer_4_popup;
              var annualWriter4Role1Count = 1;
            } else {
              var annualWriter4Role1 = "";
              var annualWriter4Role1Count = 0;
            }
            if (dataYear && role == props.writer_4_role_2 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role2 = props.writer_4_popup;
              var annualWriter4Role2Count = 1;
            } else {
              var annualWriter4Role2 = "";
              var annualWriter4Role2Count = 0;
            }
            if (dataYear && role == props.writer_4_role_3 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role3 = props.writer_4_popup;
              var annualWriter4Role3Count = 1;
            } else {
              var annualWriter4Role3 = "";
              var annualWriter4Role3Count = 0;
            }
            if (dataYear && role == props.writer_4_role_4 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role4 = props.writer_4_popup;
              var annualWriter4Role4Count = 1;
            } else {
              var annualWriter4Role4 = "";
              var annualWriter4Role4Count = 0;
            }
            if (dataYear && role == props.writer_4_role_5 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role5 = props.writer_4_popup;
              var annualWriter4Role5Count = 1;
            } else {
              var annualWriter4Role5 = "";
              var annualWriter4Role5Count = 0;
            }
            if (dataYear && role == props.writer_5_role_1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role1 = props.writer_5_popup;
              var annualWriter5Role1Count = 1;
            } else {
              var annualWriter5Role1 = "";
              var annualWriter5Role1Count = 0;
            }
            if (dataYear && role == props.writer_5_role_2 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role2 = props.writer_5_popup;
              var annualWriter5Role2Count = 1;
            } else {
              var annualWriter5Role2 = "";
              var annualWriter5Role2Count = 0;
            }
            if (dataYear && role == props.writer_5_role_3 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role3 = props.writer_5_popup;
              var annualWriter5Role3Count = 1;
            } else {
              var annualWriter5Role3 = "";
              var annualWriter5Role3Count = 0;
            }
            if (dataYear && role == props.writer_5_role_4 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role4 = props.writer_5_popup;
              var annualWriter5Role4Count = 1;
            } else {
              var annualWriter5Role4 = "";
              var annualWriter5Role4Count = 0;
            }
            if (dataYear && role == props.writer_5_role_5 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role5 = props.writer_5_popup;
              var annualWriter5Role5Count = 1;
            } else {
              var annualWriter5Role5 = "";
              var annualWriter5Role5Count = 0;
            }
          };

          // if a language and "2+" is selected...
          if (language != 0 && langValue == 2) {
            // filter by role, multilingual, and language
            if (dataYear && role == props.writer_1_role_1 && props.writer_1_languages > 1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role1 = props.writer_1_popup;
              var annualWriter1Role1Count = 1;
            } else {
              var annualWriter1Role1 = "";
              var annualWriter1Role1Count = 0;
            }
            if (dataYear && role == props.writer_1_role_2 && props.writer_1_languages > 1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role2 = props.writer_1_popup;
              var annualWriter1Role2Count = 1;
            } else {
              var annualWriter1Role2 = "";
              var annualWriter1Role2Count = 0;
            }
            if (dataYear && role == props.writer_1_role_3 && props.writer_1_languages > 1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role3 = props.writer_1_popup;
              var annualWriter1Role3Count = 1;
            } else {
              var annualWriter1Role3 = "";
              var annualWriter1Role3Count = 0;
            }
            if (dataYear && role == props.writer_1_role_4 && props.writer_1_languages > 1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role4 = props.writer_1_popup;
              var annualWriter1Role4Count = 1;
            } else {
              var annualWriter1Role4 = "";
              var annualWriter1Role4Count = 0;
            }
            if (dataYear && role == props.writer_1_role_5 && props.writer_1_languages > 1 && (language == props.writer_1_language_1 || language == props.writer_1_language_2 || language == props.writer_1_language_3 || language == props.writer_1_language_4)) {
              var annualWriter1Role5 = props.writer_1_popup;
              var annualWriter1Role5Count = 1;
            } else {
              var annualWriter1Role5 = "";
              var annualWriter1Role5Count = 0;
            }
            if (dataYear && role == props.writer_2_role_1 && props.writer_2_languages > 1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role1 = props.writer_2_popup;
              var annualWriter2Role1Count = 1;
            } else {
              var annualWriter2Role1 = "";
              var annualWriter2Role1Count = 0;
            }
            if (dataYear && role == props.writer_2_role_2 && props.writer_2_languages > 1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role2 = props.writer_2_popup;
              var annualWriter2Role2Count = 1;
            } else {
              var annualWriter2Role2 = "";
              var annualWriter2Role2Count = 0;
            }
            if (dataYear && role == props.writer_2_role_3 && props.writer_2_languages > 1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role3 = props.writer_2_popup;
              var annualWriter2Role3Count = 1;
            } else {
              var annualWriter2Role3 = "";
              var annualWriter2Role3Count = 0;
            }
            if (dataYear && role == props.writer_2_role_4 && props.writer_2_languages > 1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role4 = props.writer_2_popup;
              var annualWriter2Role4Count = 1;
            } else {
              var annualWriter2Role4 = "";
              var annualWriter2Role4Count = 0;
            }
            if (dataYear && role == props.writer_2_role_5 && props.writer_2_languages > 1 && (language == props.writer_2_language_1 || language == props.writer_2_language_2 || language == props.writer_2_language_3 || language == props.writer_2_language_4)) {
              var annualWriter2Role5 = props.writer_2_popup;
              var annualWriter2Role5Count = 1;
            } else {
              var annualWriter2Role5 = "";
              var annualWriter2Role5Count = 0;
            }
            if (dataYear && role == props.writer_3_role_1 && props.writer_3_languages > 1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role1 = props.writer_3_popup;
              var annualWriter3Role1Count = 1;
            } else {
              var annualWriter3Role1 = "";
              var annualWriter3Role1Count = 0;
            }
            if (dataYear && role == props.writer_3_role_2 && props.writer_3_languages > 1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role2 = props.writer_3_popup;
              var annualWriter3Role2Count = 1;
            } else {
              var annualWriter3Role2 = "";
              var annualWriter3Role2Count = 0;
            }
            if (dataYear && role == props.writer_3_role_3 && props.writer_3_languages > 1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role3 = props.writer_3_popup;
              var annualWriter3Role3Count = 1;
            } else {
              var annualWriter3Role3 = "";
              var annualWriter3Role3Count = 0;
            }
            if (dataYear && role == props.writer_3_role_4 && props.writer_3_languages > 1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role4 = props.writer_3_popup;
              var annualWriter3Role4Count = 1;
            } else {
              var annualWriter3Role4 = "";
              var annualWriter3Role4Count = 0;
            }
            if (dataYear && role == props.writer_3_role_5 && props.writer_3_languages > 1 && (language == props.writer_3_language_1 || language == props.writer_3_language_2 || language == props.writer_3_language_3 || language == props.writer_3_language_4)) {
              var annualWriter3Role5 = props.writer_3_popup;
              var annualWriter3Role5Count = 1;
            } else {
              var annualWriter3Role5 = "";
              var annualWriter3Role5Count = 0;
            }
            if (dataYear && role == props.writer_4_role_1 && props.writer_4_languages > 1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role1 = props.writer_4_popup;
              var annualWriter4Role1Count = 1;
            } else {
              var annualWriter4Role1 = "";
              var annualWriter4Role1Count = 0;
            }
            if (dataYear && role == props.writer_4_role_2 && props.writer_4_languages > 1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role2 = props.writer_4_popup;
              var annualWriter4Role2Count = 1;
            } else {
              var annualWriter4Role2 = "";
              var annualWriter4Role2Count = 0;
            }
            if (dataYear && role == props.writer_4_role_3 && props.writer_4_languages > 1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role3 = props.writer_4_popup;
              var annualWriter4Role3Count = 1;
            } else {
              var annualWriter4Role3 = "";
              var annualWriter4Role3Count = 0;
            }
            if (dataYear && role == props.writer_4_role_4 && props.writer_4_languages > 1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role4 = props.writer_4_popup;
              var annualWriter4Role4Count = 1;
            } else {
              var annualWriter4Role4 = "";
              var annualWriter4Role4Count = 0;
            }
            if (dataYear && role == props.writer_4_role_5 && props.writer_4_languages > 1 && (language == props.writer_4_language_1 || language == props.writer_4_language_2 || language == props.writer_4_language_3 || language == props.writer_4_language_4)) {
              var annualWriter4Role5 = props.writer_4_popup;
              var annualWriter4Role5Count = 1;
            } else {
              var annualWriter4Role5 = "";
              var annualWriter4Role5Count = 0;
            }
            if (dataYear && role == props.writer_5_role_1 && props.writer_5_languages > 1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role1 = props.writer_5_popup;
              var annualWriter5Role1Count = 1;
            } else {
              var annualWriter5Role1 = "";
              var annualWriter5Role1Count = 0;
            }
            if (dataYear && role == props.writer_5_role_2 && props.writer_5_languages > 1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role2 = props.writer_5_popup;
              var annualWriter5Role2Count = 1;
            } else {
              var annualWriter5Role2 = "";
              var annualWriter5Role2Count = 0;
            }
            if (dataYear && role == props.writer_5_role_3 && props.writer_5_languages > 1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role3 = props.writer_5_popup;
              var annualWriter5Role3Count = 1;
            } else {
              var annualWriter5Role3 = "";
              var annualWriter5Role3Count = 0;
            }
            if (dataYear && role == props.writer_5_role_4 && props.writer_5_languages > 1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role4 = props.writer_5_popup;
              var annualWriter5Role4Count = 1;
            } else {
              var annualWriter5Role4 = "";
              var annualWriter5Role4Count = 0;
            }
            if (dataYear && role == props.writer_5_role_5 && props.writer_5_languages > 1 && (language == props.writer_5_language_1 || language == props.writer_5_language_2 || language == props.writer_5_language_3 || language == props.writer_5_language_4)) {
              var annualWriter5Role5 = props.writer_5_popup;
              var annualWriter5Role5Count = 1;
            } else {
              var annualWriter5Role5 = "";
              var annualWriter5Role5Count = 0;
            }
          };

          // if gender is selected...
          if (gender != 0) {
            // for role by individual year, gather popup content
            if (role == props.writer_1_role_1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role1 = props.writer_1_popup;
              var annualWriter1Role1Count = 1;
            } else {
              var annualWriter1Role1 = "";
              var annualWriter1Role1Count = 0;
            }
            if (role == props.writer_1_role_2 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role2 = props.writer_1_popup;
              var annualWriter1Role2Count = 1;
            } else {
              var annualWriter1Role2 = "";
              var annualWriter1Role2Count = 0;
            }
            if (role == props.writer_1_role_3 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role3 = props.writer_1_popup;
              var annualWriter1Role3Count = 1;
            } else {
              var annualWriter1Role3 = "";
              var annualWriter1Role3Count = 0;
            }
            if (role == props.writer_1_role_4 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role4 = props.writer_1_popup;
              var annualWriter1Role4Count = 1;
            } else {
              var annualWriter1Role4 = "";
              var annualWriter1Role4Count = 0;
            }
            if (role == props.writer_1_role_5 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role5 = props.writer_1_popup;
              var annualWriter1Role5Count = 1;
            } else {
              var annualWriter1Role5 = "";
              var annualWriter1Role5Count = 0;
            }
            if (role == props.writer_2_role_1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role1 = props.writer_2_popup;
              var annualWriter2Role1Count = 1;
            } else {
              var annualWriter2Role1 = "";
              var annualWriter2Role1Count = 0;
            }
            if (role == props.writer_2_role_2 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role2 = props.writer_2_popup;
              var annualWriter2Role2Count = 1;
            } else {
              var annualWriter2Role2 = "";
              var annualWriter2Role2Count = 0;
            }
            if (role == props.writer_2_role_3 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role3 = props.writer_2_popup;
              var annualWriter2Role3Count = 1;
            } else {
              var annualWriter2Role3 = "";
              var annualWriter2Role3Count = 0;
            }
            if (role == props.writer_2_role_4 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role4 = props.writer_2_popup;
              var annualWriter2Role4Count = 1;
            } else {
              var annualWriter2Role4 = "";
              var annualWriter2Role4Count = 0;
            }
            if (role == props.writer_2_role_5 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role5 = props.writer_2_popup;
              var annualWriter2Role5Count = 1;
            } else {
              var annualWriter2Role5 = "";
              var annualWriter2Role5Count = 0;
            }
            if (role == props.writer_3_role_1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role1 = props.writer_3_popup;
              var annualWriter3Role1Count = 1;
            } else {
              var annualWriter3Role1 = "";
              var annualWriter3Role1Count = 0;
            }
            if (role == props.writer_3_role_2 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role2 = props.writer_3_popup;
              var annualWriter3Role2Count = 1;
            } else {
              var annualWriter3Role2 = "";
              var annualWriter3Role2Count = 0;
            }
            if (role == props.writer_3_role_3 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role3 = props.writer_3_popup;
              var annualWriter3Role3Count = 1;
            } else {
              var annualWriter3Role3 = "";
              var annualWriter3Role3Count = 0;
            }
            if (role == props.writer_3_role_4 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role4 = props.writer_3_popup;
              var annualWriter3Role4Count = 1;
            } else {
              var annualWriter3Role4 = "";
              var annualWriter3Role4Count = 0;
            }
            if (role == props.writer_3_role_5 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role5 = props.writer_3_popup;
              var annualWriter3Role5Count = 1;
            } else {
              var annualWriter3Role5 = "";
              var annualWriter3Role5Count = 0;
            }
            if (role == props.writer_4_role_1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role1 = props.writer_4_popup;
              var annualWriter4Role1Count = 1;
            } else {
              var annualWriter4Role1 = "";
              var annualWriter4Role1Count = 0;
            }
            if (role == props.writer_4_role_2 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role2 = props.writer_4_popup;
              var annualWriter4Role2Count = 1;
            } else {
              var annualWriter4Role2 = "";
              var annualWriter4Role2Count = 0;
            }
            if (role == props.writer_4_role_3 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role3 = props.writer_4_popup;
              var annualWriter4Role3Count = 1;
            } else {
              var annualWriter4Role3 = "";
              var annualWriter4Role3Count = 0;
            }
            if (role == props.writer_4_role_4 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role4 = props.writer_4_popup;
              var annualWriter4Role4Count = 1;
            } else {
              var annualWriter4Role4 = "";
              var annualWriter4Role4Count = 0;
            }
            if (role == props.writer_4_role_5 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role5 = props.writer_4_popup;
              var annualWriter4Role5Count = 1;
            } else {
              var annualWriter4Role5 = "";
              var annualWriter4Role5Count = 0;
            }
            if (role == props.writer_5_role_1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role1 = props.writer_5_popup;
              var annualWriter5Role1Count = 1;
            } else {
              var annualWriter5Role1 = "";
              var annualWriter5Role1Count = 0;
            }
            if (role == props.writer_5_role_2 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role2 = props.writer_5_popup;
              var annualWriter5Role2Count = 1;
            } else {
              var annualWriter5Role2 = "";
              var annualWriter5Role2Count = 0;
            }
            if (role == props.writer_5_role_3 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role3 = props.writer_5_popup;
              var annualWriter5Role3Count = 1;
            } else {
              var annualWriter5Role3 = "";
              var annualWriter5Role3Count = 0;
            }
            if (role == props.writer_5_role_4 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role4 = props.writer_5_popup;
              var annualWriter5Role4Count = 1;
            } else {
              var annualWriter5Role4 = "";
              var annualWriter5Role4Count = 0;
            }
            if (role == props.writer_5_role_5 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role5 = props.writer_5_popup;
              var annualWriter5Role5Count = 1;
            } else {
              var annualWriter5Role5 = "";
              var annualWriter5Role5Count = 0;
            }
          };

          // if gender and language are selected...
          if (gender != 0 && language != 0) {
            if([props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role = props.writer_1_popup;
              var annualWriter1RoleCount = 1;
            } else {
              var annualWriter1Role = "";
              var annualWriter1RoleCount = 0;
            }
            if([props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role = props.writer_2_popup;
              var annualWriter2RoleCount = 1;
            } else {
              var annualWriter2Role = "";
              var annualWriter2RoleCount = 0;
            }
            if([props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role = props.writer_3_popup;
              var annualWriter3RoleCount = 1;
            } else {
              var annualWriter3Role = "";
              var annualWriter3RoleCount = 0;
            }
            if([props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role = props.writer_4_popup;
              var annualWriter4RoleCount = 1;
            } else {
              var annualWriter4Role = "";
              var annualWriter4RoleCount = 0;
            }
            if([props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role = props.writer_5_popup;
              var annualWriter5RoleCount = 1;
            } else {
              var annualWriter5Role = "";
              var annualWriter5RoleCount = 0;
            }
          };

          // if gender and multilingual are selected...
          if (gender != 0 && langValue == 2) {
            if([props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Role = props.writer_1_popup;
              var annualWriter1RoleCount = 1;
            } else {
              var annualWriter1Role = "";
              var annualWriter1RoleCount = 0;
            }
            if([props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Role = props.writer_2_popup;
              var annualWriter2RoleCount = 1;
            } else {
              var annualWriter2Role = "";
              var annualWriter2RoleCount = 0;
            }
            if([props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Role = props.writer_3_popup;
              var annualWriter3RoleCount = 1;
            } else {
              var annualWriter3Role = "";
              var annualWriter3RoleCount = 0;
            }
            if([props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Role = props.writer_4_popup;
              var annualWriter4RoleCount = 1;
            } else {
              var annualWriter4Role = "";
              var annualWriter4RoleCount = 0;
            }
            if([props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Role = props.writer_5_popup;
              var annualWriter5RoleCount = 1;
            } else {
              var annualWriter5Role = "";
              var annualWriter5RoleCount = 0;
            }
          };

          // sum the number of writers per country who perform the chosen role
          var annualWriterRoleCount = annualWriter1Role1Count + annualWriter1Role2Count + annualWriter1Role3Count + annualWriter1Role4Count + annualWriter1Role5Count + annualWriter2Role1Count + annualWriter2Role2Count + annualWriter2Role3Count + annualWriter2Role4Count + annualWriter2Role5Count + annualWriter3Role1Count + annualWriter3Role2Count + annualWriter3Role3Count + annualWriter3Role4Count + annualWriter3Role5Count + annualWriter4Role1Count + annualWriter4Role2Count + annualWriter4Role3Count + annualWriter4Role4Count + annualWriter4Role5Count + annualWriter5Role1Count + annualWriter5Role2Count + annualWriter5Role3Count + annualWriter5Role4Count + annualWriter5Role5Count;

          // if gender and language or gender and multilingual are selected...
          if (gender != 0 && language != 0 || gender != 0 && langValue == 2) {
            var annualWriterRoleCount = annualWriter1RoleCount + annualWriter2RoleCount + annualWriter3RoleCount + annualWriter4RoleCount + annualWriter5RoleCount;
          };

          // calculate a radius for annual writers by role
          var annualWriterRoleRadius = calcRadius(Number(annualWriterRoleCount));

          // for role performed by individual year, name the popup content, but leave undefined
          var annualWriterRolePopup;

          // for role performed by individual year, define the popup content when a country features writers for that role
          if (annualWriterRoleCount > 0) {
            annualWriterRolePopup = "<b>" + props.country + "&nbsp;(" + annualWriterRoleCount + ")</b><hr />" + annualWriter1Role1 + annualWriter1Role2 + annualWriter1Role3 + annualWriter1Role4 + annualWriter1Role5 + annualWriter2Role1 + annualWriter2Role2 + annualWriter2Role3 + annualWriter2Role4 + annualWriter2Role5 + annualWriter3Role1 + annualWriter3Role2 + annualWriter3Role3 + annualWriter3Role4 + annualWriter3Role5 + annualWriter4Role1 + annualWriter4Role2 + annualWriter4Role3 + annualWriter4Role4 + annualWriter4Role5 + annualWriter5Role1 + annualWriter5Role2 + annualWriter5Role3 + annualWriter5Role4 + annualWriter5Role5;

            // if gender and language or gender and multilingual are selected...
            if (gender != 0 && language != 0 || gender != 0 && langValue == 2) {
              annualWriterRolePopup = "<b>" + props.country + "&nbsp;(" + annualWriterRoleCount + ")</b><hr />" + annualWriter1Role + annualWriter2Role + annualWriter3Role + annualWriter4Role + annualWriter5Role;
            };
          };

          // bind the annual writer popup when a role is selected
          layer.bindPopup(annualWriterRolePopup, {
            maxHeight: 300,
            maxWidth: 350
          });

        };
        // END ANNUAL WRITER ROLE CONDITIONS

        // ANNUAL WRITER BIRTH CONDITIONS
        if (countValue == "annual" && birth != 0) {
          if (birth == props.writer_1_birth && dataYear) {
            var annualWriter1Birth = props.writer_1_popup;
            var annualWriter1BirthCount = 1;
          } else {
            var annualWriter1Birth = "";
            var annualWriter1BirthCount = 0;
          }
          if (birth == props.writer_2_birth && dataYear) {
            var annualWriter2Birth = props.writer_2_popup;
            var annualWriter2BirthCount = 1;
          } else {
            var annualWriter2Birth = "";
            var annualWriter2BirthCount = 0;
          }
          if (birth == props.writer_3_birth && dataYear) {
            var annualWriter3Birth = props.writer_3_popup;
            var annualWriter3BirthCount = 1;
          } else {
            var annualWriter3Birth = "";
            var annualWriter3BirthCount = 0;
          }
          if (birth == props.writer_4_birth && dataYear) {
            var annualWriter4Birth = props.writer_4_popup;
            var annualWriter4BirthCount = 1;
          } else {
            var annualWriter4Birth = "";
            var annualWriter4BirthCount = 0;
          }
          if (birth == props.writer_5_birth && dataYear) {
            var annualWriter5Birth = props.writer_5_popup;
            var annualWriter5BirthCount = 1;
          } else {
            var annualWriter5Birth = "";
            var annualWriter5BirthCount = 0;
          }
          // if a language is selected...
          if (language != 0) {
            if ([props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if ([props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if ([props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if ([props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if ([props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if "2+" is selected...
          if (langValue == 2) {
            if (birth == props.writer_1_birth && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if gender is selected...
          if (gender != 0) {
            if (birth == props.writer_1_birth && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if gender and "2+" are selected...
          if (gender != 0 && langValue == 2) {
            if (birth == props.writer_1_birth && gender == props.writer_1_gender && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && gender == props.writer_2_gender && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && gender == props.writer_3_gender && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && gender == props.writer_4_gender && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && gender == props.writer_5_gender && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if gender and language are selected
          if (gender != 0 && language != 0) {
            if (birth == props.writer_1_birth && gender == props.writer_1_gender && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && gender == props.writer_2_gender && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && gender == props.writer_3_gender && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && gender == props.writer_4_gender && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && gender == props.writer_5_gender && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if language and "2+" is selected...
          if (language != 0 && langValue == 2) {
            if ([props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && props.writer_1_languages > 1 && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if ([props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && props.writer_2_languages > 1 && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if ([props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && props.writer_3_languages > 1 && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if ([props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && props.writer_4_languages > 1 && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if ([props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && props.writer_5_languages > 1 && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };
          // if gender, "2+", and language are selected
          if (gender != 0 && langValue == 2 && language != 0) {
            if (birth == props.writer_1_birth && gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          // ADD BIRTH AND ROLE CONDITIONS HERE
          if (role != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && language != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && langValue == 2) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && gender != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && language != 0 && langValue == 2) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && language != 0 && gender != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && langValue == 2 && gender != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          if (role != 0 && language != 0 && langValue == 2 && gender != 0) {
            if (birth == props.writer_1_birth && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && props.writer_1_languages > 1 && gender == props.writer_1_gender && dataYear) {
              var annualWriter1Birth = props.writer_1_popup;
              var annualWriter1BirthCount = 1;
            } else {
              var annualWriter1Birth = "";
              var annualWriter1BirthCount = 0;
            }
            if (birth == props.writer_2_birth && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && props.writer_2_languages > 1 && gender == props.writer_2_gender && dataYear) {
              var annualWriter2Birth = props.writer_2_popup;
              var annualWriter2BirthCount = 1;
            } else {
              var annualWriter2Birth = "";
              var annualWriter2BirthCount = 0;
            }
            if (birth == props.writer_3_birth && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && props.writer_3_languages > 1 && gender == props.writer_3_gender && dataYear) {
              var annualWriter3Birth = props.writer_3_popup;
              var annualWriter3BirthCount = 1;
            } else {
              var annualWriter3Birth = "";
              var annualWriter3BirthCount = 0;
            }
            if (birth == props.writer_4_birth && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && props.writer_4_languages > 1 && gender == props.writer_4_gender && dataYear) {
              var annualWriter4Birth = props.writer_4_popup;
              var annualWriter4BirthCount = 1;
            } else {
              var annualWriter4Birth = "";
              var annualWriter4BirthCount = 0;
            }
            if (birth == props.writer_5_birth && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && props.writer_5_languages > 1 && gender == props.writer_5_gender && dataYear) {
              var annualWriter5Birth = props.writer_5_popup;
              var annualWriter5BirthCount = 1;
            } else {
              var annualWriter5Birth = "";
              var annualWriter5BirthCount = 0;
            }
          };

          var annualWriterBirthCount = annualWriter1BirthCount + annualWriter2BirthCount + annualWriter3BirthCount + annualWriter4BirthCount + annualWriter5BirthCount;

          // calculate a radius for annual writers by birth
          var annualWriterBirthRadius = calcRadius(Number(annualWriterBirthCount));

          // for birth year, name the popup content, but leave undefined
          var annualWriterBirthPopup;

          // for year of birth, define the popup content when a country features writers for that birth year
          if (annualWriterBirthCount > 0) {
            annualWriterBirthPopup = "<b>" + props.country + "&nbsp;(" + annualWriterBirthCount + ")</b><hr />" + annualWriter1Birth + annualWriter2Birth + annualWriter3Birth + annualWriter4Birth + annualWriter5Birth;
          };

          // bind the annual writer popup when a birth year is selected
          layer.bindPopup(annualWriterBirthPopup, {
            maxHeight: 300,
            maxWidth: 350
          });

        };
        // END ANNUAL WRITER BIRTH CONDITIONS

        // ANNUAL WRITER GENDER CONDITIONS
        if (countValue == "annual" && gender != 0) {

          // Try this instead...

          // Write a function to handle the writer data
          function handleWriterData(writerNumber, languagesCheck = false, roleCheck = false, birthCheck = false, langAndLanguageCheck = false, langAndRoleCheck = false, langAndBirthCheck = false, langAndRoleAndLanguageCheck = false) {
            const writerGender = props[`writer_${writerNumber}_gender`]; // extracts the gender of the specified writer from the props object based on the writerNumber
            const writerLanguages = props[`writer_${writerNumber}_languages`]; // extracts the number of languages spoken by the specified writer from the props object based on the writerNumber
            const writerPopup = props[`writer_${writerNumber}_popup`]; // extracts the popup data for the specified writer from the props object based on the writerNumber
            // creates an array containing the languages spoken by the specified writer by extracting language data from the props object based on the writerNumber
            const writerLanguageArray = [
              props[`writer_${writerNumber}_language_1`],
              props[`writer_${writerNumber}_language_2`],
              props[`writer_${writerNumber}_language_3`],
              props[`writer_${writerNumber}_language_4`]
            ];
            // creates an array containing the roles of the specified writer by extracting role data from the props object based on the writerNumber
            const writerRoleArray = [
              props[`writer_${writerNumber}_role_1`],
              props[`writer_${writerNumber}_role_2`],
              props[`writer_${writerNumber}_role_3`],
              props[`writer_${writerNumber}_role_4`],
              props[`writer_${writerNumber}_role_5`]
            ];
            // extracts the birth year of the specified writer from the props object based on the writerNumber
            const writerBirth = props[`writer_${writerNumber}_birth`];

            let annualWriterGen = ""; // initializes a variable to store the generated data for the specified writer
            let annualWriterGenCount = 0; // initializes a variable to store the count associated with the generated data for the specified writer.

            // if the gender matches the gender of the specified writer and if dataYear is true...
            if (gender == writerGender && dataYear) { 
              // if either languagesCheck is false or if it's true, it checks if the writer speaks more than one language or if the specified language is included in the writer's language array...
              if (!languagesCheck || (languagesCheck && writerLanguages > 1) || (languagesCheck && writerLanguageArray.includes(language))) {
                // if either roleCheck is false or if it's true, it checks if the specified role is included in the writer's role array...
                if (!roleCheck || (roleCheck && writerRoleArray.includes(role))) {
                  // if the birth year is not specified or if it is specified and matches the birth year of the specified writer...
                  if (!birthCheck || (birthCheck && birth == writerBirth)) {
                    // if langAndLanguageCheck is false or if it's true, it checks if the writer speaks more than one language or if the specified language is included in the writer's language array...
                    if (!langAndLanguageCheck || (langAndLanguageCheck && writerLanguages > 1 && writerLanguageArray.includes(language))) {
                      // if langAndLanguageCheck is false or if it's true, it checks if the writer speaks more than one language or if the specified language is included in the writer's language array...
                      if (!langAndRoleCheck || (langAndRoleCheck && writerLanguages > 1 && writerRoleArray.includes(role))) {
                        // if langAndBirthCheck is false or if it's true, it checks if the writer speaks more than one language or if the birth year matches the birth year of the specified writer...
                        if (!langAndBirthCheck || (langAndBirthCheck && writerLanguages > 1 && birth == writerBirth)) {
                          // if the conditions are met...
                          if (!langAndRoleAndLanguageCheck || (langAndRoleAndLanguageCheck && writerLanguages > 1 && writerLanguageArray.includes(language) && writerRoleArray.includes(role))) {
                            annualWriterGen = writerPopup; // assigns the popup data of the specified writer to the annualWriterGen variable
                            annualWriterGenCount = 1; // sets the count associated with the generated data to 1
                          };
                        };      
                      };
                    };
                  };
                };
              };
            };

            // returns an array containing the generated data and its count for the specified writer
            return [annualWriterGen, annualWriterGenCount]; 
          };

          // Handle writer data
          var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1);
          var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2);
          var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3);
          var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4);
          var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5);

          // Handle 2+ case
          if (langValue == 2) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, true);
          };

          // Handle language selection
          if (language != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, true);
          };

          // Handle role selection
          if (role != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, true);
          };  
          
          // Handle birth year selection
          if (birth != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, false, true);
          };   
          
          // Handle "2+" and language selection
          if (langValue == 2 && language != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, false, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, false, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, false, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, false, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, false, false, true);
          };
          
          // Handle "2+" and role selection
          if (langValue == 2 && role != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, true);
          }; 
          
          // Handle "2+" and birth selection
          if (langValue == 2 && birth != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, false, false, false, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, false, false, false, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, false, false, false, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, false, false, false, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, false, false, false, false, true);
          };
          
          // Handle language and role selection
          if (language != 0 && role != 0) {
            var [annualWriter1Gen, annualWriter1GenCount] = handleWriterData(1, false, false, false, false, false, false, true);
            var [annualWriter2Gen, annualWriter2GenCount] = handleWriterData(2, false, false, false, false, false, false, true);
            var [annualWriter3Gen, annualWriter3GenCount] = handleWriterData(3, false, false, false, false, false, false, true);
            var [annualWriter4Gen, annualWriter4GenCount] = handleWriterData(4, false, false, false, false, false, false, true);
            var [annualWriter5Gen, annualWriter5GenCount] = handleWriterData(5, false, false, false, false, false, false, true);
          };         

/*          
          if (gender == props.writer_1_gender && dataYear) {
            var annualWriter1Gen = props.writer_1_popup;
            var annualWriter1GenCount = 1;
          } else {
            var annualWriter1Gen = "";
            var annualWriter1GenCount = 0;
          }
          if (gender == props.writer_2_gender && dataYear) {
            var annualWriter2Gen = props.writer_2_popup;
            var annualWriter2GenCount = 1;
          } else {
            var annualWriter2Gen = "";
            var annualWriter2GenCount = 0;
          }
          if (gender == props.writer_3_gender && dataYear) {
            var annualWriter3Gen = props.writer_3_popup;
            var annualWriter3GenCount = 1;
          } else {
            var annualWriter3Gen = "";
            var annualWriter3GenCount = 0;
          }
          if (gender == props.writer_4_gender && dataYear) {
            var annualWriter4Gen = props.writer_4_popup;
            var annualWriter4GenCount = 1;
          } else {
            var annualWriter4Gen = "";
            var annualWriter4GenCount = 0;
          }
          if (gender == props.writer_5_gender && dataYear) {
            var annualWriter5Gen = props.writer_5_popup;
            var annualWriter5GenCount = 1;
          } else {
            var annualWriter5Gen = "";
            var annualWriter5GenCount = 0;
          }
          // if "2+" is selected...
          if (langValue == 2) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if language is selected...
          if (language != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };         
          // if role is selected...
          if (role != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };          
          // if birth year is selected...
          if (birth != 0) {
            if (gender == props.writer_1_gender && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };        
          // if "2+" and language are selected...
          if (langValue == 2 && language != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };        
          // if "2+" and role are selected
          if (langValue == 2 && role != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };          
          // if "2+" and birth are selected
          if (langValue == 2 && birth != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };       
          // if language and role are selected...
          if (language != 0 && role != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
*/             
          // if language and birth are selected...
          if (language != 0 && birth != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if role and birth are selected...
          if (role != 0 && birth != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if "2+", language, and role are selected...
          if (langValue == 2 && language != 0 && role != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if "2+", language, and birth year are selected...
          if (langValue == 2 && language != 0 && birth != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if "2+", role, and birth year are selected...
          if (langValue == 2 && role != 0 && birth != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if language, role, and birth year are selected...
          if (language != 0 && role != 0 && birth != 0) {
            if (gender == props.writer_1_gender && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };
          // if "2+", language, role, and birth year are selected...
          if (langValue == 2 && language != 0 && role != 0 && birth != 0) {
            if (gender == props.writer_1_gender && props.writer_1_languages > 1 && [props.writer_1_language_1, props.writer_1_language_2, props.writer_1_language_3, props.writer_1_language_4].includes(language) && [props.writer_1_role_1, props.writer_1_role_2, props.writer_1_role_3, props.writer_1_role_4, props.writer_1_role_5].includes(role) && birth == props.writer_1_birth && dataYear) {
              var annualWriter1Gen = props.writer_1_popup;
              var annualWriter1GenCount = 1;
            } else {
              var annualWriter1Gen = "";
              var annualWriter1GenCount = 0;
            }
            if (gender == props.writer_2_gender && props.writer_2_languages > 1 && [props.writer_2_language_1, props.writer_2_language_2, props.writer_2_language_3, props.writer_2_language_4].includes(language) && [props.writer_2_role_1, props.writer_2_role_2, props.writer_2_role_3, props.writer_2_role_4, props.writer_2_role_5].includes(role) && birth == props.writer_2_birth && dataYear) {
              var annualWriter2Gen = props.writer_2_popup;
              var annualWriter2GenCount = 1;
            } else {
              var annualWriter2Gen = "";
              var annualWriter2GenCount = 0;
            }
            if (gender == props.writer_3_gender && props.writer_3_languages > 1 && [props.writer_3_language_1, props.writer_3_language_2, props.writer_3_language_3, props.writer_3_language_4].includes(language) && [props.writer_3_role_1, props.writer_3_role_2, props.writer_3_role_3, props.writer_3_role_4, props.writer_3_role_5].includes(role) && birth == props.writer_3_birth && dataYear) {
              var annualWriter3Gen = props.writer_3_popup;
              var annualWriter3GenCount = 1;
            } else {
              var annualWriter3Gen = "";
              var annualWriter3GenCount = 0;
            }
            if (gender == props.writer_4_gender && props.writer_4_languages > 1 && [props.writer_4_language_1, props.writer_4_language_2, props.writer_4_language_3, props.writer_4_language_4].includes(language) && [props.writer_4_role_1, props.writer_4_role_2, props.writer_4_role_3, props.writer_4_role_4, props.writer_4_role_5].includes(role) && birth == props.writer_4_birth && dataYear) {
              var annualWriter4Gen = props.writer_4_popup;
              var annualWriter4GenCount = 1;
            } else {
              var annualWriter4Gen = "";
              var annualWriter4GenCount = 0;
            }
            if (gender == props.writer_5_gender && props.writer_5_languages > 1 && [props.writer_5_language_1, props.writer_5_language_2, props.writer_5_language_3, props.writer_5_language_4].includes(language) && [props.writer_5_role_1, props.writer_5_role_2, props.writer_5_role_3, props.writer_5_role_4, props.writer_5_role_5].includes(role) && birth == props.writer_5_birth && dataYear) {
              var annualWriter5Gen = props.writer_5_popup;
              var annualWriter5GenCount = 1;
            } else {
              var annualWriter5Gen = "";
              var annualWriter5GenCount = 0;
            }
          };

          var annualWriterGenCount = annualWriter1GenCount + annualWriter2GenCount + annualWriter3GenCount + annualWriter4GenCount + annualWriter5GenCount;

          // calculate a radius for annual writers by birth
          var annualWriterGenRadius = calcRadius(Number(annualWriterGenCount));

          // for birth year, name the popup content, but leave undefined
          var annualWriterGenPopup;

          // for year of birth, define the popup content when a country features writers for that birth year
          if (annualWriterGenCount > 0) {
            annualWriterGenPopup = "<b>" + props.country + "&nbsp;(" + annualWriterGenCount + ")</b><hr />" + annualWriter1Gen + annualWriter2Gen + annualWriter3Gen + annualWriter4Gen + annualWriter5Gen;
          };

          // bind the annual writer popup when a birth year is selected
          layer.bindPopup(annualWriterGenPopup, {
            maxHeight: 300,
            maxWidth: 350
          });
        };
        // END ANNUAL WRITER GENDER CONDITIONS

        if (country != 0) {
          if (country == props.country_id && dataYear) {
            setLayerProperties(layer, radius);
            if (region == props.subregion && dataYear) {
              setLayerProperties(layer, radius);
            }
            if (macroRegion == props.region_un && dataYear) {
              setLayerProperties(layer, radius);
            }
            otherYearConditions(updateYear, props, countValue, layer, radius, annualRadius);
            multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (region != 0) {
          if (region == props.subregion && dataYear) {
            setLayerProperties(layer, radius);
            if (country == props.Country_ID && dataYear) {
              setLayerProperties(layer, radius);
            }
            if (macroRegion == props.region_un && dataYear) {
              setLayerProperties(layer, radius);
            }
            otherYearConditions(updateYear, props, countValue, layer, radius, annualRadius);
            multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (macroRegion != 0) {
          if (macroRegion == props.region_un && dataYear) {
            setLayerProperties(layer, radius);
            if (country == props.Country_ID && dataYear) {
              setLayerProperties(layer, radius);
            }
            if (region == props.subregion && dataYear) {
              setLayerProperties(layer, radius);
            }
            otherYearConditions(updateYear, props, countValue, layer, radius, annualRadius);
            multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (updateYear != 0 && countValue == "cumulative") {
          if (updateYear >= props.min_year && updateYear <= props.max_year && countValue == "cumulative") {
            // set the radius using the variable above
            setLayerProperties(layer, radius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (updateYear != 0 && countValue == "annual") {
          if (updateYear == props.min_year && countValue == "annual") {
            setLayerProperties(layer, annualRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (langValue == 2) {
          if (dataYear && langValue == 2 && countValue == "annual") {
            setLayerProperties(layer, annualMultiRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          } else {
            removeLayerProperties(layer);
          }
        } else if (language != 0) {
          if (dataYear && language != 0 && countValue == "annual") { // IS language != 0 NECESSARY HERE?
            setLayerProperties(layer, annualWriterLangRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            if (language != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterLangRadius);
            }
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          }
          if (dataYear && language != 0 && countValue == "cumulative") { // IS language != 0 NECESSARY HERE?
            setLayerProperties(layer, cumulativeWriterLangRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            if (language != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterLangRadius);
            }
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius);
          }
          else {
            removeLayerProperties(layer);
          }
        } else if (birth != 0) {
          if (dataYear && birth != 0 && countValue == "annual") {
            setLayerProperties(layer, annualWriterBirthRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            if (birth != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterBirthRadius);
            }
          }
          if (dataYear && birth != 0 && countValue == "cumulative") {
            setLayerProperties(layer, cumulativeWriterBirthRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius);
            if (birth != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterBirthRadius);
            }
          }
          else {
            removeLayerProperties(layer);
          }
        }
        else if (gender != 0) {
          if (dataYear && gender != 0 && countValue == "annual") {
            setLayerProperties(layer, annualWriterGenRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            if (gender != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterGenRadius);
            }
            if (birth != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterBirthRadius);
            }
          }
          if (dataYear && gender != 0 && countValue == "cumulative") {
            setLayerProperties(layer, cumulativeWriterGenRadius);
            geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius);
            yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius);
            languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius);
            roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius);
            if (gender != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterGenRadius);
            }
            if (birth != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterBirthRadius);
            }
          }
          else {
            removeLayerProperties(layer);
          }
        }
        else {
          if (updateYear >= props.min_year && updateYear <= props.max_year) {
            // set the radius using the variable above
            setLayerProperties(layer, radius);
          } else {
            removeLayerProperties(layer);
          }
        }

      });
      cumulativePart.addTo(map);
      cumulativePart.bringToFront(); // keep it from falling behind the countries layer
    };

    // function to set the layer properties
    function setLayerProperties(layer, radius) {
      layer.setRadius(radius);
      layer.setStyle({
        opacity: 1,
        weight: 1,
        fillOpacity: 0.25
      });
    };
    
    // function to remove layer properties
    function removeLayerProperties(layer) {
      layer.setRadius(0);
      layer.setStyle({
        opacity: 0,
        weight: 0,
        fillOpacity: 0
      });
    };

    // functions to refer to commonly shared conditions
    function geographicalConditions(country, props, dataYear, region, macroRegion, layer, radius) {
            if (country == props.Country_ID && dataYear) {
              setLayerProperties(layer, radius);
            }
            if (region == props.subregion && dataYear) {
              setLayerProperties(layer, radius);
            }
            if (macroRegion == props.region_un && dataYear) {
              setLayerProperties(layer, radius);
            }
    };

    function yearConditions(updateYear, props, countValue, dataYear, langValue, layer, radius, annualRadius, cumulativeMultiRadius) {
            if (updateYear >= props.min_year && updateYear <= props.max_year && countValue == "cumulative") {
              setLayerProperties(layer, radius);
            }
            if (updateYear == props.min_year && countValue == "annual") {
              setLayerProperties(layer, annualRadius);
            }
            if (dataYear && langValue == 2 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeMultiRadius);
            }
    };

    function otherYearConditions(updateYear, props, countValue, layer, radius, annualRadius) {
            if (updateYear >= props.min_year && updateYear <= props.max_year && countValue == "cumulative") {
              setLayerProperties(layer, radius);
            }
            if (updateYear == props.min_year && countValue == "annual") {
              setLayerProperties(layer, annualRadius);
            }      
    };

    function languageConditions(language, countValue, layer, annualWriterLangRadius, cumulativeWriterLangRadius) {
            if (language != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterLangRadius);
            }
            if (language != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterLangRadius);
            }
    };

    function multilingualConditions(dataYear, langValue, countValue, layer, annualMultiRadius, cumulativeMultiRadius) {
            if (dataYear && langValue == 2 && countValue == "annual") {
              setLayerProperties(layer, annualMultiRadius);
            }
            if (dataYear && langValue == 2 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeMultiRadius);
            }
    };

    function roleConditions(role, countValue, layer, annualWriterRoleRadius, cumulativeWriterRoleRadius) {
            if (role != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterRoleRadius);
            }
            if (role != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterRoleRadius);
            }
    };

    function genderConditions(gender, countValue, layer, annualWriterGenRadius, cumulativeWriterGenRadius) {
            if (gender != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterGenRadius);
            }
            if (gender != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterGenRadius);
            }
    };

    function birthConditions(birth, countValue, layer, annualWriterBirthRadius, cumulativeWriterBirthRadius) {
            if (birth != 0 && countValue == "annual") {
              setLayerProperties(layer, annualWriterBirthRadius);
            }
            if (birth != 0 && countValue == "cumulative") {
              setLayerProperties(layer, cumulativeWriterBirthRadius);
            }
    };

  </script>
</html>
